(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{191:function(e,t,n){},226:function(e,t,n){"use strict";n.r(t);var c,a,r,i,o,s,l=n(0),d=n.n(l),j=n(17),u=n.n(j),b=(n(191),n(133)),p=n.n(b),h=n(154),O=n(13),f=n(265),x=n(267),v=n(290),m=n(291),g=n(292),k=n(293),y=n(56),C=n(288),w=n(295),A=n(83),I=n.n(A),S=n(70),E=n.n(S),N=n(26),_=n(27),P=n(166),L=n(298),R=n(297),W=n(294),B=n(39),D=n(270),z=n(271),F=n(305),Q=n(303),q=n(269),$=n(235),G=n(278),V=n(82),T=n.n(V),U=n(119),H=n.n(U),K=n(161),M=n.n(K),Y=n(165),J=n(273),X=n(308),Z=n(23),ee=n(24),te=Object(ee.a)(c||(c=Object(Z.a)(["\n  query getEvents {\n    events {\n      id\n      name\n      checkpoint_count\n      created_at\n    }\n  }\n"]))),ne=Object(ee.a)(a||(a=Object(Z.a)(["\n  query getEvent($id: Int!) {\n    event(id: $id) {\n      id\n      name\n      type\n      checkpoint_count\n      virtual_challenge {\n        id\n      }\n      checkpoints {\n        id\n        cp_id\n        cp_code\n        event_id\n        skipped\n        skip_reason\n      }\n    }\n  }\n"]))),ce=Object(ee.a)(r||(r=Object(Z.a)(["\n  mutation CreateEvent($name: String!, $checkpointCount: Int!, $type: Int!) {\n    createEvent(name: $name, checkpointCount: $checkpointCount, type: $type) {\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),ae=Object(ee.a)(i||(i=Object(Z.a)(["\n  mutation CreateCheckpoint(\n    $eventId: Int!\n    $cpId: Int!\n    $cpCode: String\n    $skipped: Boolean\n    $skipReason: String\n  ) {\n    createCheckpoint(\n      event_id: $eventId\n      cp_id: $cpId\n      cp_code: $cpCode\n      skipped: $skipped\n      skip_reason: $skipReason\n    ) {\n      checkpoint {\n        id\n        event_id\n        cp_id\n        cp_code\n        skipped\n        skip_reason\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),re=Object(ee.a)(o||(o=Object(Z.a)(["\n  mutation DeleteEvent($id: Int!) {\n    deleteEvent(id: $id) {\n      id\n    }\n  }\n"]))),ie=Object(ee.a)(s||(s=Object(Z.a)(["\n  mutation DeleteCheckpoint($id: Int!) {\n    deleteCheckpoint(id: $id) {\n      id\n    }\n  }\n"]))),oe=n(302),se=n(268),le=n(2),de=Object(f.a)((function(e){return Object(x.a)({listWrapper:{padding:10}})})),je=function(e){var t=de();return Object(le.jsxs)(oe.a,{"aria-labelledby":"simple-checklist-title",open:!0,onClose:e.handleClose,children:[Object(le.jsx)(se.a,{id:"simple-checklist-title",children:"Rzeczy do zabrania"}),Object(le.jsx)(q.a,{className:t.listWrapper,children:["4 kanapki","dwa bidony wody","kubek Kuby","jab\u0142ko w kawa\u0142kach","banan","ciastka","pampersy","chusteczki mokre","worek na \u015bmieci","chusteczki zwyk\u0142e","p\u0119seta","octenisept","\u017cel do dezynfekcji"].map((function(e,t){return Object(le.jsx)(D.a,{dense:!0,children:Object(le.jsx)(z.a,{primary:e,primaryTypographyProps:{variant:"body1"}})},t)}))})]})},ue=d.a.createContext(!1),be=function(e){var t=e.children,n=Object(l.useState)(null),c=Object(O.a)(n,2),a=c[0],r=c[1],i=Object(l.useState)(!0),o=Object(O.a)(i,2),s=o[0],d=o[1],j=Object(N.g)();return Object(l.useEffect)((function(){a?a!==j.pathname&&d(!1):r(j.pathname)}),[a,j.pathname,s,d]),Object(le.jsx)(ue.Provider,{value:(!a||a===j.pathname)&&s,children:t})};function pe(){return Object(l.useContext)(ue)}var he=Object(f.a)((function(e){return Object(x.a)({link:{display:"flex"},icon:{marginRight:e.spacing(.5),width:20,height:20}})})),Oe=n(272),fe=Object(f.a)((function(e){return Object(x.a)({root:{height:4}})})),xe=function(e){var t=e.active,n=fe();return Object(le.jsx)("div",{className:n.root,children:t&&Object(le.jsx)(Oe.a,{color:"secondary"})})},ve=function(e){var t=e.id,n=e.name,c=e.createdAt;return Object(le.jsx)(D.a,{button:!0,component:_.b,to:"/events/".concat(t),children:Object(le.jsx)(z.a,{primary:n,secondary:Object(Y.a)(new Date(c),"dd/MM/yyyy")})})},me=Object(f.a)((function(e){return Object(x.a)({wrapper:{display:"flex",width:"100%"},deleteIcon:{},icons:{display:"flex",justifyContent:"space-between"},listWrapper:{},addEventButton:{position:"absolute",right:"1em",bottom:"5em"}})})),ge=function(){var e=pe(),t=Object(J.a)(te,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),n=t.loading,c=t.error,a=t.data,r=Object(l.useState)(!1),i=Object(O.a)(r,2),o=i[0],s=i[1],d=Object(X.a)(re,{refetchQueries:["getEvents"],awaitRefetchQueries:!0}),j=Object(O.a)(d,1)[0],u=me(),b=he();return n&&!a?Object(le.jsx)("p",{children:"Loading..."}):c?Object(le.jsx)("p",{children:"Error :("}):Object(le.jsxs)("div",{className:u.listWrapper,children:[Object(le.jsx)(F.a,{px:1,py:2,children:Object(le.jsx)(Q.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(y.a,{color:"textPrimary",className:b.link,children:[Object(le.jsx)(E.a,{className:b.icon}),"Events"]})})}),Object(le.jsx)(xe,{active:n}),c&&Object(le.jsx)("p",{children:"Error :("}),Object(le.jsx)(q.a,{children:Object(B.a)(a.events).sort((function(e,t){return t.id-e.id})).map((function(e){var t=e.id,n=e.name,c=e.created_at;return Object(le.jsxs)("div",{className:u.wrapper,children:[Object(le.jsx)(ve,{id:t,name:n,createdAt:c}),Object(le.jsxs)("div",{className:u.icons,children:[Object(le.jsx)($.a,{"aria-label":"checklist",onClick:function(){s(!0)},children:Object(le.jsx)(M.a,{})}),Object(le.jsx)($.a,{"aria-label":"delete",onClick:function(){return j({variables:{id:t}})},children:Object(le.jsx)(H.a,{})})]})]},t)}))}),o&&Object(le.jsx)(je,{handleClose:function(){s(!1)}}),Object(le.jsx)(G.a,{className:u.addEventButton,color:"primary","aria-label":"add",component:_.b,to:"/events/new",children:Object(le.jsx)(T.a,{})})]})},ke=n(279),ye=n(296),Ce=n(280),we=n(281),Ae=n(306),Ie=n(283),Se=n(300),Ee=n(284),Ne=n(285),_e=n(50),Pe=Object(f.a)((function(e){return Object(x.a)({radioGroupWrapper:{paddingTop:25,paddingBottom:10},title:{paddingBottom:0},radioLabel:{fontSize:"0.6rem"}})})),Le=function(){var e=Object(l.useState)(""),t=Object(O.a)(e,2),n=t[0],c=t[1],a=Object(l.useState)(""),r=Object(O.a)(a,2),i=r[0],o=r[1],s=Object(l.useState)("score"),d=Object(O.a)(s,2),j=d[0],u=d[1],b=Object(N.f)(),p=Object(X.a)(ce,{refetchQueries:[{query:te}],awaitRefetchQueries:!0,onCompleted:function(e){b.push("/events/".concat(e.createEvent.event.id))}}),h=Object(O.a)(p,1)[0],f=Pe(),x=function(){b.push("/")};return Object(le.jsxs)(oe.a,{open:!0,keepMounted:!0,onClose:x,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(le.jsx)(se.a,{id:"alert-dialog-slide-title",className:f.title,children:"Create a new event"}),Object(le.jsx)(_e.b,{onSubmit:function(){var e="score"===j?1:2;return h({variables:{name:n,checkpointCount:parseInt(i,10),type:e}})},render:function(e){var t=e.handleSubmit;return Object(le.jsxs)("form",{onSubmit:t,children:[Object(le.jsxs)(ke.a,{children:[Object(le.jsx)(_e.a,{name:"name",render:function(e){e.input;var t=e.meta;return Object(le.jsxs)("div",{children:[Object(le.jsx)(ye.a,{id:"standard-basic",label:"Name",required:!0,autoComplete:"off",onChange:function(e){return c(e.target.value)}}),t.touched&&t.error&&Object(le.jsx)("span",{children:t.error})]})}}),Object(le.jsx)(_e.a,{name:"points",render:function(e){e.input;var t=e.meta;return Object(le.jsxs)("div",{children:[Object(le.jsx)(ye.a,{id:"standard-basic",label:"Points",required:!0,autoComplete:"off",onChange:function(e){return o(e.target.value)}}),t.touched&&t.error&&Object(le.jsx)("span",{children:t.error})]})}}),Object(le.jsx)(_e.a,{name:"type",render:function(){return Object(le.jsx)("div",{className:f.radioGroupWrapper,children:Object(le.jsxs)(Ce.a,{component:"fieldset",children:[Object(le.jsx)(we.a,{component:"legend",children:"Type"}),Object(le.jsxs)(Ae.a,{"aria-label":"type",name:"type",value:j,onChange:function(e){return u(e.target.value)},children:[Object(le.jsx)(Ie.a,{value:"score",control:Object(le.jsx)(Se.a,{size:"small"}),label:Object(le.jsx)(y.a,{variant:"body2",children:"Scorelauf"})}),Object(le.jsx)(Ie.a,{value:"classic",control:Object(le.jsx)(Se.a,{size:"small"}),label:Object(le.jsx)(y.a,{variant:"body2",children:"Classic"})})]})]})})}})]}),Object(le.jsxs)(Ee.a,{children:[Object(le.jsx)(Ne.a,{variant:"contained",color:"primary",type:"submit",children:"Create"}),Object(le.jsx)(Ne.a,{onClick:x,color:"primary",children:"Cancel"})]})]})}})]})},Re=n(22),We=n(162),Be=n(286),De=n(230),ze=n(168),Fe=["current","max"];var Qe=function(e){var t=e.current,n=e.max,c=Object(ze.a)(e,Fe),a=100*t/n;return Object(le.jsxs)(F.a,{display:"flex",alignItems:"center",children:[Object(le.jsx)(F.a,{width:"100%",mr:1,children:Object(le.jsx)(Oe.a,Object(Re.a)(Object(Re.a)({variant:"determinate"},c),{},{value:a}))}),Object(le.jsx)(F.a,{minWidth:35,children:Object(le.jsxs)(y.a,{variant:"body2",color:"textSecondary",children:[t,"/",n]})})]})},qe=function(e){var t=e.scoredIds,n=e.max,c=Array(n).fill(n).map((function(e,t){return 1+t})).filter((function(e){return!t.includes(e)}));return 0===t.length||t.length===n?null:Object(le.jsxs)(F.a,{mt:3,children:[Object(le.jsx)(F.a,{minWidth:35,ml:1,mb:1,children:Object(le.jsx)(y.a,{children:"Missing:"})}),Object(le.jsx)(F.a,{display:"flex",alignItems:"center",children:Object(le.jsx)(F.a,{width:"100%",ml:1,children:c.join(", ")})})]})},$e=Object(f.a)((function(e){return Object(x.a)({wrapper:{width:"100%"},header:{padding:10,paddingBottom:2,backgroundColor:"#c5cae9"},content:{border:"1px solid #c5cae9",width:"100%",paddingLeft:10,paddingRight:10,paddingBottom:10,padding:10,boxSizing:"border-box"},deleteIcon:{position:"absolute",top:-3,right:-5}})})),Ge=function(e){var t,n=e.checkpoint,c=e.onDelete,a=$e();return Object(le.jsxs)("div",{style:{display:"flex",flexDirection:"row",position:"relative"},children:[Object(le.jsxs)("div",{className:a.wrapper,children:[Object(le.jsx)("div",{className:a.header,children:Object(le.jsx)(y.a,{variant:"button",color:"textSecondary",children:n.cp_id})}),Object(le.jsx)("div",{className:a.content,children:Object(le.jsx)(y.a,{variant:"subtitle1",children:Object(le.jsx)("span",{children:n.skipped?"skipped":null===(t=n.cp_code)||void 0===t?void 0:t.toUpperCase()})})})]}),Object(le.jsx)("div",{className:a.deleteIcon,children:Object(le.jsx)($.a,{"aria-label":"delete",onClick:function(){return c(n)},children:Object(le.jsx)(H.a,{})})})]})},Ve=function(e){var t=e.checkpoints,n=e.max,c=Array(n).fill(n).map((function(e,t){return 1+t})).map((function(e){var n=t.find((function(t){return t.cp_id===e}));return!n||n.skipped?"...":n.cp_code}));return Object(le.jsxs)(F.a,{mt:3,children:[Object(le.jsx)(F.a,{minWidth:35,ml:1,mb:1,children:Object(le.jsx)(y.a,{variant:"h6",children:"Solution:"})}),Object(le.jsx)(F.a,{display:"flex",alignItems:"center",children:Object(le.jsx)(F.a,{width:"100%",ml:1,children:c.join(" ")})})]})},Te=d.a.createContext({queue:[],errored:[]}),Ue=d.a.createContext((function(){})),He=function(e,t){switch(t.type){case"add":return Object(Re.a)(Object(Re.a)({},e),{},{queue:[].concat(Object(B.a)(e.queue),[{checkpoint:t.checkpoint,eventId:t.eventId}])});case"delete":return Object(Re.a)(Object(Re.a)({},e),{},{queue:e.queue.filter((function(e){return e.eventId!==t.eventId||e.checkpoint.cpId!==t.id})),errored:e.errored.filter((function(e){return e.eventId!==t.eventId||e.checkpoint.cpId!==t.id}))});case"errored":return Object(Re.a)(Object(Re.a)({},e),{},{queue:e.queue.filter((function(e){return e.eventId!==t.eventId||e.checkpoint.cpId!==t.checkpoint.cpId})),errored:[].concat(Object(B.a)(e.errored),[{error:t.error,eventId:t.eventId,checkpoint:Object(Re.a)({},t.checkpoint)}])})}return e},Ke=function(e){var t=e.children,n=Object(l.useReducer)(He,{queue:[],errored:[]},(function(e){var t=localStorage.getItem("checkpointsServiceStorage");if(!t)return e;try{var n=JSON.parse(t);return{queue:[].concat(Object(B.a)(n.queue),Object(B.a)(n.errored)),errored:[]}}catch(c){return e}})),c=Object(O.a)(n,2),a=c[0],r=c[1];return Object(l.useEffect)((function(){localStorage.setItem("checkpointsServiceStorage",JSON.stringify(a))}),[a]),Object(le.jsx)(Ue.Provider,{value:r,children:Object(le.jsx)(Te.Provider,{value:a,children:t})})},Me=Object(f.a)((function(e){return Object(x.a)({root:{flexGrow:1,padding:20},paper:{width:80},item:{padding:5},pendingItem:{opacity:.7},control:{padding:e.spacing(2)},addCheckpointButton:{position:"absolute",right:"1em",bottom:"1em"}})})),Ye=function(e){var t=e.event,n=e.newCheckpointPath,c=t.checkpoints,a=d.a.useState(2),r=Object(O.a)(a,1)[0],i=Me(),o=Object(l.useContext)(Ue),s=Object(X.a)(ie,{refetchQueries:["getEvent"],awaitRefetchQueries:!0}),j=Object(O.a)(s,1)[0],u=function(e){return e.pending?o({type:"delete",eventId:t.id,id:e.cp_id}):j({variables:{id:e.id}})};return Object(le.jsxs)(F.a,{m:1,children:[Object(le.jsx)(y.a,{variant:"h6",children:t.name}),Object(le.jsx)(Qe,{current:c.length,max:t.checkpoint_count}),c.length>0&&Object(le.jsx)(Be.a,{container:!0,className:i.root,spacing:2,children:Object(le.jsx)(Be.a,{item:!0,xs:12,children:Object(le.jsx)(Be.a,{container:!0,justify:"flex-start",spacing:r,children:c.map((function(e){return Object(le.jsx)(Be.a,{item:!0,className:[i.item].concat(e.pending?[i.pendingItem]:[]).join(" "),children:Object(le.jsx)(De.a,{className:i.paper,children:Object(le.jsx)(Ge,{checkpoint:e,eventId:t.id,onDelete:u})})},e.cp_id)}))})})}),Object(le.jsx)(G.a,{className:i.addCheckpointButton,color:"primary","aria-label":"add",component:_.b,to:n,children:Object(le.jsx)(T.a,{})}),Object(le.jsx)(qe,{scoredIds:c.map((function(e){return e.cp_id})),max:t.checkpoint_count}),Object(le.jsx)(Ve,{checkpoints:c,max:t.checkpoint_count})]})},Je=function(e){var t=e.event,n=(e.virtualChallenge,e.newCheckpointPath,t.checkpoints);return Object(le.jsx)("div",{children:Object(le.jsx)(Qe,{current:n.length,max:t.checkpoint_count})})},Xe=n(287),Ze=n(301),et=Object(f.a)((function(e){return Object(x.a)({skippedText:{fontStyle:"italic"}})})),tt=function(e){var t=e.id,n=e.checkpoint,c=e.eventId,a="checkbox-list-label-".concat(t),r=Object(N.f)(),i=Object(X.a)(ae,{refetchQueries:["getEvent"],awaitRefetchQueries:!0,onCompleted:function(e){r.push("/events/".concat(e.createCheckpoint.checkpoint.event_id))}}),o=Object(O.a)(i,2),s=o[0],l=o[1],d=l.loading,j=l.error,u=Object(X.a)(ie,{refetchQueries:["getEvent"],awaitRefetchQueries:!0}),b=Object(O.a)(u,1)[0],p=et();if(d)return Object(le.jsx)("p",{children:"Loading..."});if(j)return Object(le.jsx)("p",{children:"Error :("});var h=!n&&Object(le.jsx)(Ne.a,{variant:"contained",onClick:function(e){return function(e,t){e.stopPropagation();try{return s({variables:{eventId:c,cpId:t,cpCode:void 0,skipped:!0,skipReason:void 0}})}catch(n){throw n}}(e,t)},children:"Skip"}),f=n&&n.skipped&&Object(le.jsx)("span",{className:p.skippedText,children:"skipped"});return Object(le.jsxs)(D.a,{role:void 0,dense:!0,button:!0,onClick:function(){return function(e){if(n)return b({variables:{id:n.id}});try{return s({variables:{eventId:c,cpId:e,cpCode:void 0,skipped:!1,skipReason:void 0}})}catch(t){throw t}}(t)},children:[Object(le.jsx)(Xe.a,{children:Object(le.jsx)(Ze.a,{edge:"start",checked:null!=n,tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":a}})}),Object(le.jsx)(z.a,{id:a,primary:t}),f,h]},t)},nt=function(e){var t=e.event,n=t.id,c=t.name,a=t.checkpoints,r=t.checkpoint_count,i=Array(r).fill(r).map((function(e,t){return 1+t}));return Object(le.jsxs)(F.a,{m:1,children:[Object(le.jsx)(y.a,{variant:"h6",children:c}),Object(le.jsx)(Qe,{current:a.length,max:r}),i.map((function(e){var t=a.find((function(t){return t.cp_id===e}));return Object(le.jsx)(tt,{id:e,checkpoint:t,eventId:n},e)})),Object(le.jsx)(qe,{scoredIds:a.map((function(e){return e.cp_id})),max:t.checkpoint_count})]})};var ct=1,at=function(e){var t=e.children,n=e.width,c=e.height;return Object(le.jsx)(We.a,{speed:2,width:n,height:c,viewBox:"0 0 ".concat(n," ").concat(c),backgroundColor:"#eeeeee",foregroundColor:"#cccccc",children:t})};var rt,it,ot,st,lt,dt=function(){var e=Object(N.h)().id,t=function(e){var t=Object(l.useContext)(Te),n=t.queue,c=t.errored;return[].concat(Object(B.a)(n.filter((function(t){return t.eventId===e}))),Object(B.a)(c.filter((function(t){return t.eventId===e})).map((function(e){return Object(Re.a)(Object(Re.a)({},e),{},{checkpoint:Object(Re.a)(Object(Re.a)({},e.checkpoint),{},{error:e.error})})})))).map((function(e){return e.checkpoint}))}(parseInt(e,10)),n=he(),c=pe(),a=Object(J.a)(ne,{variables:{id:parseInt(e,10)},fetchPolicy:c?"cache-and-network":void 0,nextFetchPolicy:c?"cache-first":void 0}),r=a.loading,i=a.error,o=a.data,s=function(e,t){return e?Object(Re.a)(Object(Re.a)({},e),{},{checkpoints:[].concat(Object(B.a)(e.checkpoints),Object(B.a)(t.map((function(e){return{id:0,cp_id:e.cpId,cp_code:e.cpCode,skipped:e.skipped,skip_reason:e.skipReason,pending:!0,error:e.error}}))))}):e}(null===o||void 0===o?void 0:o.event,t);if(r&&!o)return Object(le.jsxs)("div",{children:[Object(le.jsx)(F.a,{px:1,py:2,children:Object(le.jsx)(Q.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(C.a,{color:"inherit",component:_.b,to:"/",className:n.link,children:[Object(le.jsx)(E.a,{className:n.icon}),"Events"]})})}),Object(le.jsx)(F.a,{px:1,py:2,children:Object(le.jsxs)(at,{width:300,height:500,children:[Object(le.jsx)("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"45",height:"12"}),Object(le.jsx)("rect",{x:"0",y:"20",rx:"3",ry:"3",width:"250",height:"3"}),Object(le.jsx)("rect",{x:"30",y:"40",rx:"3",ry:"3",width:"80",height:"80"}),Object(le.jsx)("rect",{x:"130",y:"40",rx:"3",ry:"3",width:"80",height:"80"}),Object(le.jsx)("rect",{x:"0",y:"190",rx:"3",ry:"3",width:"45",height:"12"}),Object(le.jsx)("rect",{x:"0",y:"220",rx:"3",ry:"3",width:"100",height:"10"}),Object(le.jsx)("rect",{x:"0",y:"240",rx:"3",ry:"3",width:"100",height:"10"}),Object(le.jsx)("rect",{x:"0",y:"260",rx:"3",ry:"3",width:"100",height:"10"})]})})]});var d=s.type===ct?Object(le.jsx)(Ye,{event:s,newCheckpointPath:"/events/".concat(s.id,"/add-checkpoint")}):Object(le.jsx)(nt,{event:s});return Object(le.jsxs)("div",{children:[Object(le.jsx)(F.a,{px:1,py:2,children:Object(le.jsxs)(Q.a,{"aria-label":"breadcrumb",children:[Object(le.jsxs)(C.a,{color:"inherit",component:_.b,to:"/",className:n.link,children:[Object(le.jsx)(E.a,{className:n.icon}),"Events"]}),Object(le.jsx)(y.a,{color:"textPrimary",children:s.name})]})}),Object(le.jsx)(xe,{active:r}),i&&Object(le.jsx)("p",{children:"Error :("}),3===s.type&&s.virtual_challenge?Object(le.jsx)(Je,{event:s,virtualChallenge:s.virtual_challenge,newCheckpointPath:"/events/".concat(s.id,"/add-checkpoint")}):d]})},jt=Object(f.a)((function(e){return Object(x.a)({margin:{margin:e.spacing(1)}})})),ut=function(){var e=Object(N.h)().id,t=Object(N.f)(),n=Object(l.useContext)(Ue),c=jt();return Object(le.jsx)(_e.b,{onSubmit:function(c){n({type:"add",eventId:parseInt(e,10),checkpoint:{cpId:parseInt(c.cpId,10),cpCode:c.cpCode,skipped:c.skipped,skipReason:c.skipReason}}),t.push("/events/".concat(e))},initialValues:{skipped:!1},render:function(e){var t=e.values,n=(e.submitError,e.handleSubmit);return t.skipped&&delete t.cpCode,Object(le.jsxs)("form",{onSubmit:n,children:[Object(le.jsx)(_e.a,{name:"cpId",render:function(e){var t=e.input,n=e.meta;return Object(le.jsxs)("div",{className:c.margin,children:[Object(le.jsx)(ye.a,Object(Re.a)(Object(Re.a)({},t),{},{label:"Id",required:!0,autoComplete:"off"})),n.touched&&(n.error||n.submitError)&&Object(le.jsx)("span",{children:n.error||n.submitError})]})}}),Object(le.jsx)(_e.a,{name:"cpCode",render:function(e){var n=e.input,a=e.meta;return Object(le.jsxs)("div",{className:c.margin,children:[Object(le.jsx)(ye.a,Object(Re.a)(Object(Re.a)({},n),{},{label:"Code",required:!t.skipped,disabled:t.skipped,autoComplete:"off"})),a.touched&&(a.error||a.submitError)&&Object(le.jsx)("span",{children:a.error||a.submitError})]})}}),Object(le.jsx)(_e.a,{name:"skipped",type:"checkbox",render:function(e){var t=e.input;e.meta;return Object(le.jsx)(F.a,{display:"flex",alignItems:"center",ml:1,children:Object(le.jsx)(Ie.a,{control:Object(le.jsx)(Ze.a,Object(Re.a)(Object(Re.a)({},t),{},{checked:t.value,name:"skipped",color:"primary"})),label:"Skip"})})}}),Object(le.jsx)(Ne.a,{variant:"contained",color:"primary",type:"submit",children:"Submit"})]})}})},bt=n(307),pt=n(289),ht=n(74),Ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADB/VeXAAACH0lEQVRIDbWWPU8bQRCGZ/bsJHKDROIiJh0dFESyRRKlpggWWPkNFhUSLSWiRK6pIn6DfSCSInWUgBwpFEnnKkCBAxIUFnDcDvOusGXZTrJHLltYt3czz+zHzDtm+sM4ffH+WRxfV4i4TCSTJFRw5kzH+q6l73aD4EH4eG/+8HcYHvWh/TosyKWsC/NbFtkxFIQSmB+SyylY0Z1OgSmatjEtqs2C2tT5Ea/lP1Xc937mUIB2KVy0RFss9C5DuY3xr3Pn/Q6Dz2fFj2M31FkVpiVDVM03K9uDNr35SbGxclJq/GzPhqXeS88H+MAXjH6X3g6wciHZNNng5ZPPC0f9Rr7Pv17tTNgo/sLEy92duAA4c3tFB8bQm/x+pekLHGWHnVhLH8xDmsGd6LFpLuiF4sz/FQ4WGGCBiTkjFW/i6FtWcpN/u1A4+AxcfMSdVibIPjfIc6RiWnAsACwwwdYj4jLy3GdlSWxMQJquYGuFooiSOPvYCmW/g21Q/t0K9XH0tXFMZbss8nVKYsfRhSsBQypc0JYkzl62UeYp2LjkFsd2ysspgRHEEGxc8q6lWCU53QGlBdtAzyG5KI60QoAFJtgGzQJ6DslNKwBYYILtsgjNAnp+H5keXBQYYIGJby7AnepVxUodkjvo5DuHLxgKrXa7mwsAgNNvoRr0/D47cTKtvlq4tW4vALfXcDDBSLtlDgVwQf5n03fbuPtJ42/LLeEvKdWYGdgZAAAAAElFTkSuQmCC",ft=ht.icon({iconUrl:Ot,shadowUrl:Ot,iconSize:[24,24],shadowSize:[24,24],iconAnchor:[12,12],shadowAnchor:[12,12],popupAnchor:[-3,-76]}),xt=function(e){var t=e.initialPoint,n=e.startPoint,c=e.range,a=e.checkpoints,r=e.onDrag,i=e.onClick,o=e.onChange,s=Object(l.useRef)(null),d=Object(l.useRef)(null),j=Object(l.useState)(!1),u=Object(O.a)(j,2),b=u[0],p=u[1];return Object(l.useEffect)((function(){var e=ht.map("mapid").setView(t,13);return ht.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors,',maxZoom:18,id:"osm/streets",tileSize:512,zoomOffset:-1}).addTo(e),s.current=e,function(){e.off(),e.remove()}}),[t]),Object(l.useEffect)((function(){var e=s.current;if(e){var t=function(e){var t=e.latlng;i(t)};return e.on("click",t),function(){e.off("click",t)}}}),[i,s]),Object(l.useEffect)((function(){var e=s.current;if(n&&e){var t=ht.circle(n,{color:"red",opacity:.5,fillColor:"#fff",fillOpacity:.2,radius:500}).addTo(e),c=ht.marker(n,{draggable:!0});return c.on("dragstart",(function(e){p(!0)})),c.on("dragend",(function(e){p(!1)})),c.on("dragend",(function(e){var t=e.target.getLatLng();r(t)})),c.on("drag",(function(e){var n=e.target.getLatLng();t.setLatLng(n)})),e.addLayer(c),d.current=t,function(){d.current=null,e.removeLayer(c),e.removeLayer(t)}}}),[n,s,r]),Object(l.useEffect)((function(){d.current&&d.current.setRadius(c)}),[c,d]),Object(l.useEffect)((function(){var e;if(s.current&&d.current&&a&&!b){var t=null!==(e=null===a||void 0===a?void 0:a.map((function(e,t){return ht.marker([e.lat,e.lng],{draggable:!0,icon:ft}).bindTooltip("".concat(t+1),{permanent:!0,interactive:!1,className:"checkpoint-label",direction:"right"})})))&&void 0!==e?e:[];return t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.addLayer(e)})),t.forEach((function(e){e.on("dragend",(function(e){var n=t.map((function(e){return e.getLatLng()}));o(n)}))})),function(){t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.removeLayer(e)}))}}}),[a,d,s,b,o]),Object(le.jsx)("div",{id:"mapid",style:{height:"100%"}})},vt=Object(ee.a)(rt||(rt=Object(Z.a)(["\n  query getVirtualPoints ($input: PointsNearbyInput!) {\n    pointsNearby(input: $input) {\n      points {\n        lat\n        lng\n      }\n    }\n  }\n"]))),mt=Object(ee.a)(it||(it=Object(Z.a)(["\n  mutation CreateVirtualChallenge(\n    $input: CreateVirtualChallengeInput!\n  ) {\n    createVirtualChallenge(\n      input: $input\n    ) {\n      success\n      virtualChallenge {\n        id\n        name\n        checkpoints {\n          points {\n            lat\n            lng\n          }\n          totalCount\n        }\n      }\n    }\n  }\n"]))),gt=function(){var e=Object(l.useState)([]),t=Object(O.a)(e,2),n=t[0],c=t[1],a=Object(pt.a)(vt,{fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0}),r=Object(O.a)(a,2),i=r[0],o=r[1],s=o.loading,d=o.data,j=Object(X.a)(mt),u=Object(O.a)(j,1)[0],b=Object(l.useState)(null),p=Object(O.a)(b,2),h=p[0],f=p[1],x=Object(l.useMemo)((function(){return[54.372158,18.638306]}),[]),v=Object(l.useState)(500),m=Object(O.a)(v,2),g=m[0],k=m[1],y=Object(l.useCallback)((function(e){f([e.lat,e.lng])}),[f]),C=null!==h,w=Object(l.useCallback)((function(e){C||f([e.lat,e.lng])}),[C,f]),A=Object(l.useCallback)((function(e){c(e)}),[c]),I=Object(l.useCallback)((function(){u({variables:{input:{name:"Test",checkpoints:n.map((function(e){return{lat:e.lat.toString(),lng:e.lng.toString()}}))}}})}),[n,u]);return Object(l.useEffect)((function(){h&&i({variables:{input:{start:{lat:h[0].toString(),lng:h[1].toString()},radius:g,count:12}}})}),[i,g,h]),Object(l.useEffect)((function(){c(!s&&d?d.pointsNearby.points.map((function(e){var t=e.lat,n=e.lng;return{lat:parseFloat(t),lng:parseFloat(n)}})):[])}),[s,d]),Object(le.jsxs)("div",{children:[Object(le.jsxs)("div",{style:{height:200},children:[Object(le.jsx)(bt.a,{value:g,onChange:function(e,t){k(Array.isArray(t)?t[0]:t)},min:100,max:2e3,"aria-labelledby":"continuous-slider"}),Object(le.jsx)("br",{}),Object(le.jsx)(Ne.a,{onClick:I,children:"Create"})]}),Object(le.jsx)("div",{style:{position:"fixed",bottom:12,left:12,right:12,top:300},children:Object(le.jsx)(xt,{initialPoint:x,startPoint:h,range:g,checkpoints:n,onDrag:y,onClick:w,onChange:A})})]})},kt=Object(ee.a)(ot||(ot=Object(Z.a)(["\n  query getVirtualChallenges {\n    virtualChallenges {\n      nodes {\n        id\n        name\n        createdAt: created_at\n        checkpoints {\n          totalCount\n          points {\n            lat\n            lng\n          }\n        }\n      }\n    }\n  }\n"]))),yt=n(163),Ct=n.n(yt),wt=Object(f.a)((function(e){return Object(x.a)({addChallengeButton:{position:"absolute",right:"1em",bottom:"5em"}})})),At=function(){var e=pe(),t=wt(),n=Object(J.a)(kt,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),c=n.data,a=n.loading,r=he();return c?Object(le.jsxs)("div",{children:[Object(le.jsx)(F.a,{px:1,py:2,children:Object(le.jsx)(Q.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(y.a,{color:"textPrimary",className:r.link,children:[Object(le.jsx)(I.a,{className:r.icon}),"Virtual Challenges"]})})}),Object(le.jsx)(xe,{active:a}),Object(le.jsx)(q.a,{children:c.virtualChallenges.nodes.map((function(e){return Object(le.jsx)(D.a,{button:!0,component:_.b,to:"/virtual-challenges/".concat(e.id),children:Object(le.jsx)(Ct.a,{primary:e.name,secondary:Object(Y.a)(new Date(e.createdAt),"dd/MM/yyyy")})},e.id)}))}),Object(le.jsx)(G.a,{className:t.addChallengeButton,color:"primary","aria-label":"add",component:_.b,to:"/virtual-challenges/new",children:Object(le.jsx)(T.a,{})})]}):Object(le.jsx)("div",{children:"Loading"})},It=Object(ee.a)(st||(st=Object(Z.a)(["\n  query getVirtualChallenge($id: Int!) {\n    virtualChallenge(id: $id) {\n      id\n      name\n      createdAt: created_at\n      checkpoints {\n        totalCount\n        points {\n          lat\n          lng\n        }\n      }\n    }\n  }\n"]))),St=Object(ee.a)(lt||(lt=Object(Z.a)(["\n  mutation EnrollVirtualChallenge($id: Int!) {\n    enrollVirtualChallenge(id: $id) {\n      success\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),Et=function(){var e=pe(),t=he(),n=Object(N.f)(),c=Object(N.h)().id,a=Object(J.a)(It,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0,variables:{id:parseInt(c,10)}}).data,r=Object(X.a)(St,{refetchQueries:[{query:te}],awaitRefetchQueries:!0,onCompleted:function(e){n.push("/events/".concat(e.enrollVirtualChallenge.event.id))},variables:{id:parseInt(c,10)}}),i=Object(O.a)(r,1)[0],o=null===a||void 0===a?void 0:a.virtualChallenge;return o?Object(le.jsxs)("div",{children:[Object(le.jsx)(F.a,{px:1,py:2,children:Object(le.jsxs)(Q.a,{"aria-label":"breadcrumb",children:[Object(le.jsxs)(C.a,{color:"inherit",component:_.b,to:"/virtual-challenges",className:t.link,children:[Object(le.jsx)(I.a,{className:t.icon}),"Virtual Challenges"]}),Object(le.jsx)(y.a,{color:"textPrimary",children:o.name})]})}),Object(le.jsx)(Ne.a,{onClick:function(){return i()},children:"Join"})]}):Object(le.jsx)("div",{children:"NOT FOUND"})},Nt=n(304),_t=n(164),Pt=n.n(_t),Lt=Object(l.createContext)(null),Rt=function(){var e=Object(l.useContext)(Lt),t=Object(l.useState)(!1),n=Object(O.a)(t,2),c=n[0],a=n[1],r=Object(l.useState)(null),i=Object(O.a)(r,2),o=i[0],s=i[1];Object(l.useEffect)((function(){if(e){var t=function(e){s(e)};return e.onUpdate(t),function(){e.offUpdate(t)}}}),[e]);var j=function(){s(null)};return Object(le.jsx)(Nt.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:Boolean(o),onClose:j,message:"A new version of the app is available!",action:Object(le.jsxs)(d.a.Fragment,{children:[Object(le.jsx)(Ne.a,{color:"secondary",size:"small",onClick:function(){if(o){a(!0);var e=o.waiting;e&&(e.postMessage({type:"SKIP_WAITING"}),e.addEventListener("statechange",(function(e){var t=e.target?e.target:null;"activated"===(null===t||void 0===t?void 0:t.state)&&window.location.reload()})))}},disabled:c,children:"RELOAD"}),Object(le.jsx)($.a,{size:"small","aria-label":"close",color:"inherit",onClick:j,children:Object(le.jsx)(Pt.a,{fontSize:"small"})})]})})},Wt=n(137),Bt=function(){var e=Object(l.useContext)(Te).queue,t=Object(l.useContext)(Ue),n=e[0],c=Object(X.a)(ae,{awaitRefetchQueries:!0,onCompleted:function(e){var n=e.createCheckpoint.checkpoint,c=n.cp_id,a=n.event_id;t({type:"delete",id:c,eventId:a})}}),a=Object(O.a)(c,1)[0];return Object(l.useEffect)((function(){n&&a({refetchQueries:[{query:ne,variables:{id:n.eventId}}],variables:{eventId:n.eventId,cpId:n.checkpoint.cpId,cpCode:n.checkpoint.cpCode,skipped:n.checkpoint.skipped,skipReason:n.checkpoint.skipReason}}).catch((function(e){t({type:"errored",checkpoint:n.checkpoint,eventId:n.eventId,error:e})}))}),[n,t,a]),null},Dt=function(){var e=Object(l.useContext)(Te).errored,t=Object(l.useState)(!0),n=Object(O.a)(t,2),c=n[0],a=n[1],r=e.map((function(e){return"Error during saving point ".concat(e.checkpoint.cpId)}));return Object(l.useEffect)((function(){a(!0)}),[e,a]),0===r.length?null:Object(le.jsx)(Nt.a,{anchorOrigin:{vertical:"top",horizontal:"right"},onClose:function(){return a(!1)},open:c,message:r.map((function(e){return Object(le.jsx)("div",{children:e})})),autoHideDuration:5e3})},zt=function(){return Object(P.a)({uri:"https://woodtime-api.ertrzyiks.me/woodtime"})},Ft=Object(f.a)((function(e){return Object(x.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},loaderWrapper:{alignItems:"center",width:"100%",height:"100%",justifyContent:"center",display:"flex"},bottomBar:{position:"fixed",bottom:0,width:"100%"}})}));function Qt(e){var t=e.className,n=Object(N.f)(),c=Object(N.g)();return"/"!==c.pathname&&"/virtual-challenges"!==c.pathname?null:Object(le.jsxs)(v.a,{value:"/"===c.pathname?0:1,onChange:function(e,t){0===t?n.push("/"):n.push("/virtual-challenges")},showLabels:!0,className:t,children:[Object(le.jsx)(m.a,{label:"Events",icon:Object(le.jsx)(E.a,{})}),Object(le.jsx)(m.a,{label:"Virtual Challenges",icon:Object(le.jsx)(I.a,{})})]})}var qt=function(){var e=Object(l.useState)(null),t=Object(O.a)(e,2),n=t[0],c=t[1],a=Ft();return Object(l.useEffect)((function(){function e(){return(e=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new L.a,e.next=3,Object(Wt.b)({cache:t,storage:new Wt.a(window.localStorage)});case 3:c(new R.a({cache:t,link:zt()}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch(console.error)}),[c]),Object(le.jsxs)(_.a,{basename:"",children:[Object(le.jsx)(Rt,{}),Object(le.jsxs)(be,{children:[Object(le.jsx)(g.a,{position:"static",children:Object(le.jsx)(k.a,{children:Object(le.jsx)(y.a,{variant:"h6",className:a.title,children:Object(le.jsx)(C.a,{component:_.b,to:"/",color:"inherit",children:"Woodtime"})})})}),n?Object(le.jsxs)(W.a,{client:n,children:[Object(le.jsxs)(Ke,{children:[Object(le.jsx)(Bt,{}),Object(le.jsx)(Dt,{}),Object(le.jsxs)(N.c,{children:[Object(le.jsx)(N.a,{path:"/",exact:!0,children:Object(le.jsx)(ge,{})}),Object(le.jsxs)(N.a,{path:"/events/new",exact:!0,children:[Object(le.jsx)(ge,{}),Object(le.jsx)(Le,{})]}),Object(le.jsx)(N.a,{path:"/events/:id",exact:!0,children:Object(le.jsx)(dt,{})}),Object(le.jsx)(N.a,{path:"/events/:id/add-checkpoint",exact:!0,children:Object(le.jsx)(ut,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges",exact:!0,children:Object(le.jsx)(At,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges/new",exact:!0,children:Object(le.jsx)(gt,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges/:id",exact:!0,children:Object(le.jsx)(Et,{})})]})]}),Object(le.jsx)(Qt,{className:a.bottomBar})]}):Object(le.jsx)("div",{className:a.loaderWrapper,children:Object(le.jsx)(w.a,{})})]})]})},$t=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Gt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Vt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,310)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))},Tt=[],Ut=[],Ht=function(e){var t=e.children,n={onSuccess:function(e){return Tt.push(e)},offSuccess:function(e){return Tt.filter((function(t){return t!==e}))},onUpdate:function(e){return Ut.push(e)},offUpdate:function(e){return Ut.filter((function(t){return t!==e}))}};return Object(le.jsx)(Lt.Provider,{value:n,children:t})};u.a.render(Object(le.jsx)(d.a.StrictMode,{children:Object(le.jsx)(Ht,{children:Object(le.jsx)(qt,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");$t?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Gt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Gt(t,e)}))}}({onUpdate:function(e){Ut.forEach((function(t){return t(e)}))},onSuccess:function(){Tt.forEach((function(e){return e()}))}}),Vt()}},[[226,1,2]]]);
//# sourceMappingURL=main.2b30b3f2.chunk.js.map