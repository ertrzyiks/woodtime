(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{145:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(180),c=function(e,t,n,a){return new(n||(n=Promise))((function(c,r){function i(e){try{s(a.next(e))}catch(t){r(t)}}function o(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?c(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}s((a=a.apply(e,t||[])).next())}))},r=function(e,t){var n,a,c,r,i={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(c=2&r[0]?a.return:r[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,r[1])).done)return c;switch(a=0,c&&(r=[2&r[0],c.value]),r[0]){case 0:case 1:c=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(c=(c=i.trys).length>0&&c[c.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!c||r[1]>c[0]&&r[1]<c[3])){i.label=r[1];break}if(6===r[0]&&i.label<c[1]){i.label=c[1],c=r;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(r);break}c[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(o){r=[6,o],a=0}finally{n=c=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}};function i(){return c(this,void 0,void 0,(function(){var t;return r(this,(function(c){switch(c.label){case 0:return[4,(t=Object(a.createWorker)("object"===typeof e?{}:{corePath:n(250).default})).load()];case 1:return c.sent(),[4,t.loadLanguage("pol")];case 2:return c.sent(),[4,t.initialize("pol")];case 3:return c.sent(),[4,t.setParameters({tessedit_char_whitelist:"0123456789A\u0104BC\u0106D\u0118EFGHIJKL\u0141MN\u0143O\xd3PRS\u015aTUVWXYZ\u017b\u0179 !?-"})];case 4:return c.sent(),[2,t]}}))}))}function o(e,t){return c(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,e.recognize(t)];case 1:return[2,n.sent().data.text]}}))}))}}).call(this,n(87))},210:function(e,t,n){},274:function(e,t,n){"use strict";n.r(t);var a,c,r,i,o,s,l=n(0),d=n.n(l),u=n(17),j=n.n(u),b=(n(210),n(60)),h=n.n(b),p=n(171),f=n(14),O=n(312),v=n(314),x=n(336),m=n(337),g=n(54),y=n(334),k=n(283),w=n(339),C=n(83),A=n.n(C),S=n(27),E=n(25),I=n(184),N=n(342),P=n(341),W=n(338),L=n(185),R=n(317),D=n(318),_=n(349),B=n(347),z=n(316),F=n(325),G=n(125),$=n.n(G),Q=n(124),T=n.n(Q),U=n(123),V=n.n(U),M=n(178),H=n.n(M),K=n(183),q=n(320),Y=n(352),J=n(22),X=n(23),Z=Object(X.a)(a||(a=Object(J.a)(["\n  query getEvents {\n    events {\n      id\n      name\n      checkpoint_count\n      created_at\n    }\n  }\n"]))),ee=Object(X.a)(c||(c=Object(J.a)(["\n  query getEvent($id: Int!) {\n    event(id: $id) {\n      id\n      name\n      checkpoint_count\n      checkpoints {\n        id\n        cp_id\n        cp_code\n        event_id\n        skipped\n        skip_reason\n      }\n    }\n  }\n"]))),te=Object(X.a)(r||(r=Object(J.a)(["\n  mutation CreateEvent($name: String!, $checkpointCount: Int!, $type: Int!) {\n    createEvent(name: $name, checkpointCount: $checkpointCount, type: $type) {\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),ne=Object(X.a)(i||(i=Object(J.a)(["\n  mutation CreateCheckpoint(\n    $eventId: Int!\n    $cpId: Int!\n    $cpCode: String\n    $skipped: Boolean\n    $skipReason: String\n  ) {\n    createCheckpoint(\n      event_id: $eventId\n      cp_id: $cpId\n      cp_code: $cpCode\n      skipped: $skipped\n      skip_reason: $skipReason\n    ) {\n      checkpoint {\n        id\n        event_id\n        cp_id\n        cp_code\n        skipped\n        skip_reason\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),ae=Object(X.a)(o||(o=Object(J.a)(["\n  mutation DeleteEvent($id: Int!) {\n    deleteEvent(id: $id) {\n      id\n    }\n  }\n"]))),ce=Object(X.a)(s||(s=Object(J.a)(["\n  mutation DeleteCheckpoint($id: Int!) {\n    deleteCheckpoint(id: $id) {\n      id\n    }\n  }\n"]))),re=n(346),ie=n(315),oe=n(2),se=Object(O.a)((function(e){return Object(v.a)({listWrapper:{padding:10}})})),le=function(e){var t=se();return Object(oe.jsxs)(re.a,{"aria-labelledby":"simple-checklist-title",open:!0,onClose:e.handleClose,children:[Object(oe.jsx)(ie.a,{id:"simple-checklist-title",children:"Rzeczy do zabrania"}),Object(oe.jsx)(z.a,{className:t.listWrapper,children:["4 kanapki","dwa bidony wody","kubek Kuby","jab\u0142ko w kawa\u0142kach","banan","ciastka","pampersy","chusteczki mokre","worek na \u015bmieci","chusteczki zwyk\u0142e","p\u0119seta","octenisept","\u017cel do dezynfekcji"].map((function(e,t){return Object(oe.jsx)(R.a,{dense:!0,children:Object(oe.jsx)(D.a,{primary:e,primaryTypographyProps:{variant:"body1"}})},t)}))})]})},de=d.a.createContext(!1),ue=function(e){var t=e.children,n=Object(l.useState)(null),a=Object(f.a)(n,2),c=a[0],r=a[1],i=Object(l.useState)(!0),o=Object(f.a)(i,2),s=o[0],d=o[1],u=Object(E.g)();return Object(l.useEffect)((function(){c?c!==u.pathname&&d(!1):r(u.pathname)}),[c,u.pathname,s,d]),Object(oe.jsx)(de.Provider,{value:(!c||c===u.pathname)&&s,children:t})};function je(){return Object(l.useContext)(de)}var be=Object(O.a)((function(e){return Object(v.a)({link:{display:"flex"},icon:{marginRight:e.spacing(.5),width:20,height:20}})})),he=n(319),pe=Object(O.a)((function(e){return Object(v.a)({root:{height:4}})})),fe=function(e){var t=e.active,n=pe();return Object(oe.jsx)("div",{className:n.root,children:t&&Object(oe.jsx)(he.a,{color:"secondary"})})},Oe=function(e){var t=e.id,n=e.name,a=e.createdAt;return Object(oe.jsx)(R.a,{button:!0,component:S.b,to:"/events/".concat(t),children:Object(oe.jsx)(D.a,{primary:n,secondary:Object(K.a)(new Date(a),"dd/MM/yyyy")})})},ve=Object(O.a)((function(e){return Object(v.a)({wrapper:{display:"flex",width:"100%"},deleteIcon:{},icons:{display:"flex",justifyContent:"space-between"},listWrapper:{},addEventButton:{position:"absolute",right:"1em",bottom:"1em"}})})),xe=function(){var e=je(),t=Object(q.a)(Z,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),n=t.loading,a=t.error,c=t.data,r=Object(l.useState)(!1),i=Object(f.a)(r,2),o=i[0],s=i[1],d=Object(Y.a)(ae,{refetchQueries:["getEvents"],awaitRefetchQueries:!0}),u=Object(f.a)(d,1)[0],j=ve(),b=be();return n&&!c?Object(oe.jsx)("p",{children:"Loading..."}):a?Object(oe.jsx)("p",{children:"Error :("}):Object(oe.jsxs)("div",{className:j.listWrapper,children:[Object(oe.jsx)(_.a,{px:1,py:2,children:Object(oe.jsx)(B.a,{"aria-label":"breadcrumb",children:Object(oe.jsxs)(g.a,{color:"textPrimary",className:b.link,children:[Object(oe.jsx)(V.a,{className:b.icon}),"Events"]})})}),Object(oe.jsx)(fe,{active:n}),a&&Object(oe.jsx)("p",{children:"Error :("}),Object(oe.jsx)(z.a,{children:Object(L.a)(c.events).sort((function(e,t){return t.id-e.id})).map((function(e){var t=e.id,n=e.name,a=e.created_at;return Object(oe.jsxs)("div",{className:j.wrapper,children:[Object(oe.jsx)(Oe,{id:t,name:n,createdAt:a}),Object(oe.jsxs)("div",{className:j.icons,children:[Object(oe.jsx)(k.a,{"aria-label":"checklist",onClick:function(){s(!0)},children:Object(oe.jsx)(H.a,{})}),Object(oe.jsx)(k.a,{"aria-label":"delete",onClick:function(){return u({variables:{id:t}})},children:Object(oe.jsx)(T.a,{})})]})]},t)}))}),o&&Object(oe.jsx)(le,{handleClose:function(){s(!1)}}),Object(oe.jsx)(F.a,{className:j.addEventButton,color:"primary","aria-label":"add",component:S.b,to:"/events/new",children:Object(oe.jsx)($.a,{})})]})},me=n(326),ge=n(340),ye=n(327),ke=n(328),we=n(350),Ce=n(330),Ae=n(344),Se=n(331),Ee=n(332),Ie=n(47),Ne=Object(O.a)((function(e){return Object(v.a)({radioGroupWrapper:{paddingTop:25,paddingBottom:10},title:{paddingBottom:0},radioLabel:{fontSize:"0.6rem"}})})),Pe=function(){var e=Object(l.useState)(""),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(l.useState)(""),r=Object(f.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)("score"),d=Object(f.a)(s,2),u=d[0],j=d[1],b=Object(E.f)(),h=Object(Y.a)(te,{refetchQueries:[{query:Z}],awaitRefetchQueries:!0,onCompleted:function(e){b.push("/events/".concat(e.createEvent.event.id))}}),p=Object(f.a)(h,1)[0],O=Ne(),v=function(){b.push("/")};return Object(oe.jsxs)(re.a,{open:!0,keepMounted:!0,onClose:v,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(oe.jsx)(ie.a,{id:"alert-dialog-slide-title",className:O.title,children:"Create a new event"}),Object(oe.jsx)(Ie.b,{onSubmit:function(){var e="score"===u?1:2;return p({variables:{name:n,checkpointCount:parseInt(i,10),type:e}})},render:function(e){var t=e.handleSubmit;return Object(oe.jsxs)("form",{onSubmit:t,children:[Object(oe.jsxs)(me.a,{children:[Object(oe.jsx)(Ie.a,{name:"name",render:function(e){e.input;var t=e.meta;return Object(oe.jsxs)("div",{children:[Object(oe.jsx)(ge.a,{id:"standard-basic",label:"Name",required:!0,autoComplete:"off",onChange:function(e){return a(e.target.value)}}),t.touched&&t.error&&Object(oe.jsx)("span",{children:t.error})]})}}),Object(oe.jsx)(Ie.a,{name:"points",render:function(e){e.input;var t=e.meta;return Object(oe.jsxs)("div",{children:[Object(oe.jsx)(ge.a,{id:"standard-basic",label:"Points",required:!0,autoComplete:"off",onChange:function(e){return o(e.target.value)}}),t.touched&&t.error&&Object(oe.jsx)("span",{children:t.error})]})}}),Object(oe.jsx)(Ie.a,{name:"type",render:function(){return Object(oe.jsx)("div",{className:O.radioGroupWrapper,children:Object(oe.jsxs)(ye.a,{component:"fieldset",children:[Object(oe.jsx)(ke.a,{component:"legend",children:"Type"}),Object(oe.jsxs)(we.a,{"aria-label":"type",name:"type",value:u,onChange:function(e){return j(e.target.value)},children:[Object(oe.jsx)(Ce.a,{value:"score",control:Object(oe.jsx)(Ae.a,{size:"small"}),label:Object(oe.jsx)(g.a,{variant:"body2",children:"Scorelauf"})}),Object(oe.jsx)(Ce.a,{value:"classic",control:Object(oe.jsx)(Ae.a,{size:"small"}),label:Object(oe.jsx)(g.a,{variant:"body2",children:"Classic"})})]})]})})}})]}),Object(oe.jsxs)(Se.a,{children:[Object(oe.jsx)(Ee.a,{variant:"contained",color:"primary",type:"submit",children:"Create"}),Object(oe.jsx)(Ee.a,{onClick:v,color:"primary",children:"Cancel"})]})]})}})]})},We=n(48),Le=n(187),Re=n(333),De=n(278),_e=function(e){var t=e.scoredIds,n=e.max,a=Array(n).fill(n).map((function(e,t){return 1+t})).filter((function(e){return!t.includes(e)}));return 0===t.length||t.length===n?null:Object(oe.jsxs)(_.a,{mt:3,children:[Object(oe.jsx)(_.a,{minWidth:35,ml:1,mb:1,children:Object(oe.jsx)(g.a,{children:"Missing:"})}),Object(oe.jsx)(_.a,{display:"flex",alignItems:"center",children:Object(oe.jsx)(_.a,{width:"100%",ml:1,children:a.join(", ")})})]})},Be=Object(O.a)((function(e){return Object(v.a)({wrapper:{width:"100%"},header:{padding:10,paddingBottom:2,backgroundColor:"#c5cae9"},content:{border:"1px solid #c5cae9",width:"100%",paddingLeft:10,paddingRight:10,paddingBottom:10,padding:10,boxSizing:"border-box"},deleteIcon:{position:"absolute",top:-3,right:-5}})})),ze=function(e){var t,n=e.checkpoint,a=Object(Y.a)(ce,{refetchQueries:["getEvent"],awaitRefetchQueries:!0}),c=Object(f.a)(a,1)[0],r=Be();return Object(oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",position:"relative"},children:[Object(oe.jsxs)("div",{className:r.wrapper,children:[Object(oe.jsx)("div",{className:r.header,children:Object(oe.jsx)(g.a,{variant:"button",color:"textSecondary",children:n.cp_id})}),Object(oe.jsx)("div",{className:r.content,children:Object(oe.jsx)(g.a,{variant:"subtitle1",children:Object(oe.jsx)("span",{children:n.skipped?"skipped":null===(t=n.cp_code)||void 0===t?void 0:t.toUpperCase()})})})]}),Object(oe.jsx)("div",{className:r.deleteIcon,children:Object(oe.jsx)(k.a,{"aria-label":"delete",onClick:function(){return e=n.id,c({variables:{id:e}});var e},children:Object(oe.jsx)(T.a,{})})})]})},Fe=function(e){var t=e.checkpoints,n=e.max,a=Array(n).fill(n).map((function(e,t){return 1+t})).map((function(e){var n=t.find((function(t){return t.cp_id===e}));return!n||n.skipped?"...":n.cp_code}));return Object(oe.jsxs)(_.a,{mt:3,children:[Object(oe.jsx)(_.a,{minWidth:35,ml:1,mb:1,children:Object(oe.jsx)(g.a,{variant:"h6",children:"Solution:"})}),Object(oe.jsx)(_.a,{display:"flex",alignItems:"center",children:Object(oe.jsx)(_.a,{width:"100%",ml:1,children:a.join(" ")})})]})},Ge=["current","max"];function $e(e){var t=e.current,n=e.max,a=Object(Le.a)(e,Ge),c=100*t/n;return Object(oe.jsxs)(_.a,{display:"flex",alignItems:"center",children:[Object(oe.jsx)(_.a,{width:"100%",mr:1,children:Object(oe.jsx)(he.a,Object(We.a)(Object(We.a)({variant:"determinate"},a),{},{value:c}))}),Object(oe.jsx)(_.a,{minWidth:35,children:Object(oe.jsxs)(g.a,{variant:"body2",color:"textSecondary",children:[t,"/",n]})})]})}var Qe=Object(O.a)((function(e){return Object(v.a)({root:{flexGrow:1,padding:20},paper:{width:80},item:{padding:5},control:{padding:e.spacing(2)},addCheckpointButton:{position:"absolute",right:"1em",bottom:"1em"}})})),Te=function(e){var t=e.event,n=e.newCheckpointPath,a=t.checkpoints,c=d.a.useState(2),r=Object(f.a)(c,1)[0],i=Qe();return Object(oe.jsxs)(_.a,{m:1,children:[Object(oe.jsx)(g.a,{variant:"h6",children:t.name}),Object(oe.jsx)($e,{current:a.length,max:t.checkpoint_count}),a.length>0&&Object(oe.jsx)(Re.a,{container:!0,className:i.root,spacing:2,children:Object(oe.jsx)(Re.a,{item:!0,xs:12,children:Object(oe.jsx)(Re.a,{container:!0,justify:"flex-start",spacing:r,children:a.map((function(e){return Object(oe.jsx)(Re.a,{item:!0,className:i.item,children:Object(oe.jsx)(De.a,{className:i.paper,children:Object(oe.jsx)(ze,{checkpoint:e,eventId:t.id})})},e.cp_id)}))})})}),Object(oe.jsx)(F.a,{className:i.addCheckpointButton,color:"primary","aria-label":"add",component:S.b,to:n,children:Object(oe.jsx)($.a,{})}),Object(oe.jsx)(_e,{scoredIds:a.map((function(e){return e.cp_id})),max:t.checkpoint_count}),Object(oe.jsx)(Fe,{checkpoints:a,max:t.checkpoint_count})]})},Ue=function(){var e=Object(E.h)().id,t=be(),n=je(),a=Object(q.a)(ee,{variables:{id:parseInt(e,10)},fetchPolicy:n?"cache-and-network":void 0,nextFetchPolicy:n?"cache-first":void 0}),c=a.loading,r=a.error,i=a.data,o=null===i||void 0===i?void 0:i.event;return c&&!i?Object(oe.jsx)("p",{children:"Loading..."}):Object(oe.jsxs)("div",{children:[Object(oe.jsx)(_.a,{px:1,py:2,children:Object(oe.jsxs)(B.a,{"aria-label":"breadcrumb",children:[Object(oe.jsxs)(y.a,{color:"inherit",component:S.b,to:"/",className:t.link,children:[Object(oe.jsx)(V.a,{className:t.icon}),"Events"]}),Object(oe.jsx)(g.a,{color:"textPrimary",children:o.name})]})}),Object(oe.jsx)(fe,{active:c}),r&&Object(oe.jsx)("p",{children:"Error :("}),Object(oe.jsx)(Te,{event:o,newCheckpointPath:"/events/".concat(o.id,"/add-checkpoint")})]})},Ve=n(97),Me=n(345),He=n(69),Ke=n(179),qe=n.n(Ke),Ye=function(e,t,n){var a=t*(4*n)+4*e;return[a,a+1,a+2,a+3]},Je=function(e,t,n){return n*e+t};var Xe=n(145);var Ze,et,tt,nt,at,ct=function(){return(ct=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var c in t=arguments[n])Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c]);return e}).apply(this,arguments)},rt=function(e,t,n,a){return new(n||(n=Promise))((function(c,r){function i(e){try{s(a.next(e))}catch(t){r(t)}}function o(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?c(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}s((a=a.apply(e,t||[])).next())}))},it=function(e,t){var n,a,c,r,i={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(c=2&r[0]?a.return:r[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,r[1])).done)return c;switch(a=0,c&&(r=[2&r[0],c.value]),r[0]){case 0:case 1:c=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(c=(c=i.trys).length>0&&c[c.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!c||r[1]>c[0]&&r[1]<c[3])){i.label=r[1];break}if(6===r[0]&&i.label<c[1]){i.label=c[1],c=r;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(r);break}c[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(o){r=[6,o],a=0}finally{n=c=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},ot=function(e){var t=e.onRead,n=Object(l.useRef)(),a=Object(l.useRef)(),c=Object(l.useRef)(),r=Object(l.useState)(null),i=r[0],o=r[1];return a.current||(a.current=document.createElement("canvas")),Object(l.useEffect)((function(){return Object(Xe.a)().then((function(e){return n.current=e})),function(){n.current&&n.current.terminate()}}),[n]),Object(l.useEffect)((function(){var e=!1,t=function(){e=!0,i&&i.getTracks().forEach((function(e){e.stop()}))};if(i)return t;var n=c.current;var a=navigator.mediaDevices.getSupportedConstraints();return navigator.mediaDevices.getUserMedia({audio:!1,video:ct({width:{exact:320},height:{exact:240}},a.facingMode?{facingMode:"environment"}:{})}).then((function(t){e||(o(t),n.srcObject=t)})).catch((function(t){e||console.log("navigator.MediaDevices.getUserMedia error: ",t)})),t}),[i,c]),Object(l.useEffect)((function(){var e=setInterval((function(){return rt(void 0,void 0,void 0,(function(){var e,r,i,o,s;return it(this,(function(l){switch(l.label){case 0:return e=a.current,0===(r=c.current).videoWidth||0===r.videoHeight?[2]:(e.width=r.videoWidth,e.height=r.videoHeight,(i=e.getContext("2d")).drawImage(r,0,0,e.width,e.height),function(e){for(var t=e.canvas,n=t.width,a=t.height,c=e.getImageData(0,0,n,a),r=c.data,i=[],o=0;o<n;o++)for(var s=0;s<a;s++){var l=Ye(o,s,n),d=l[0],u=l[1],j=l[2],b=r[d],h=r[u],p=r[j],f=Math.ceil(b+h+p)/3;i.push(f)}var O=qe()(i),v=i.map((function(e){return e>O}));for(o=0;o<n;o++)for(s=0;s<a;s++){var x=Je(o,s,a),m=Ye(o,s,n),g=(d=m[0],u=m[1],j=m[2],m[3]);v[x]?(r[d]=255,r[u]=255,r[j]=255,r[g]=255):(r[d]=0,r[u]=0,r[j]=0,r[g]=255)}e.putImageData(c,0,0)}(i),n.current?[4,Object(Xe.b)(n.current,e.toDataURL())]:[2]);case 1:return o=l.sent(),(s=function(e){var t=e.match(/([0-9]{1,2})\s+(.{3})/);return t?{id:parseInt(t[1],10),code:t[2]}:null}(o))&&t(s),[2]}}))}))}),1e3);return function(){clearInterval(e)}}),[a,c]),l.createElement("div",{style:{width:300,height:225,overflow:"hidden"}},l.createElement("video",{playsInline:!0,autoPlay:!0,ref:c,style:{width:"100%",height:"calc(var(--width) * 0.75)"}}))},st=Object(O.a)((function(e){return Object(v.a)({margin:{margin:e.spacing(1)}})})),lt=function(){var e=Object(l.useState)(!1),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(l.useState)(null),r=Object(f.a)(c,2),i=r[0],o=r[1],s=Object(E.h)().id,d=Object(E.f)(),u=Object(Y.a)(ne,{refetchQueries:["getEvent"],awaitRefetchQueries:!0,onCompleted:function(e){d.push("/events/".concat(e.createCheckpoint.checkpoint.event_id))}}),j=Object(f.a)(u,2),b=j[0],h=j[1],p=h.loading,O=h.error,v=st();return p?Object(oe.jsx)("p",{children:"Loading..."}):O?Object(oe.jsx)("p",{children:"Error :("}):Object(oe.jsx)(Ie.b,{onSubmit:function(e){try{return b({variables:{eventId:parseInt(s,10),cpId:parseInt(e.cpId,10),cpCode:e.cpCode,skipped:e.skipped,skipReason:e.skipReason}})}catch(t){return t?t.message&&t.message.startsWith("Checkpoint")?{id:"Id already taken"}:Object(Ve.a)({},He.a,t.message||t):Object(Ve.a)({},He.a,"Something went wrong")}},initialValues:{skipped:!1},render:function(e){var t=e.values,c=e.submitError,r=e.handleSubmit;return t.skipped&&delete t.cpCode,Object(oe.jsxs)("form",{onSubmit:r,children:[c&&Object(oe.jsx)("div",{className:"error",children:c}),Object(oe.jsx)(Ie.a,{name:"cpId",render:function(e){var t=e.input,n=e.meta;return Object(oe.jsxs)("div",{className:v.margin,children:[Object(oe.jsx)(ge.a,Object(We.a)(Object(We.a)({},t),{},{label:"Id",required:!0,autoComplete:"off"})),n.touched&&(n.error||n.submitError)&&Object(oe.jsx)("span",{children:n.error||n.submitError})]})}}),Object(oe.jsx)(Ie.a,{name:"cpCode",render:function(e){var n=e.input,a=e.meta;return Object(oe.jsxs)("div",{className:v.margin,children:[Object(oe.jsx)(ge.a,Object(We.a)(Object(We.a)({},n),{},{label:"Code",required:!t.skipped,disabled:t.skipped,autoComplete:"off"})),a.touched&&(a.error||a.submitError)&&Object(oe.jsx)("span",{children:a.error||a.submitError})]})}}),Object(oe.jsx)(Ie.a,{name:"skipped",type:"checkbox",render:function(e){var t=e.input;e.meta;return Object(oe.jsx)(_.a,{display:"flex",alignItems:"center",ml:1,children:Object(oe.jsx)(Ce.a,{control:Object(oe.jsx)(Me.a,Object(We.a)(Object(We.a)({},t),{},{checked:t.value,name:"skipped",color:"primary"})),label:"Skip"})})}}),Object(oe.jsx)("div",{style:{marginTop:16,marginBottom:16,width:300,height:225},children:n?Object(oe.jsxs)("div",{style:{position:"relative"},children:[Object(oe.jsx)(ot,{onRead:function(e){o(e)}}),Object(oe.jsx)(Ee.a,{variant:"contained",color:"secondary",onClick:function(){return a(!1)},style:{position:"absolute",bottom:0,right:0},children:"Cancel"})]}):Object(oe.jsx)("div",{style:{width:300,height:225,background:"grey",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(oe.jsx)(Ee.a,{variant:"contained",color:"secondary",onClick:function(){return a(!0)},children:"Scan"})})}),i&&Object(oe.jsxs)("div",{children:[i.id," - ",i.code]}),Object(oe.jsx)(Ee.a,{variant:"contained",color:"primary",type:"submit",children:"Submit"})]})}})},dt=n(351),ut=n(335),jt=n(75),bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADB/VeXAAACH0lEQVRIDbWWPU8bQRCGZ/bsJHKDROIiJh0dFESyRRKlpggWWPkNFhUSLSWiRK6pIn6DfSCSInWUgBwpFEnnKkCBAxIUFnDcDvOusGXZTrJHLltYt3czz+zHzDtm+sM4ffH+WRxfV4i4TCSTJFRw5kzH+q6l73aD4EH4eG/+8HcYHvWh/TosyKWsC/NbFtkxFIQSmB+SyylY0Z1OgSmatjEtqs2C2tT5Ea/lP1Xc937mUIB2KVy0RFss9C5DuY3xr3Pn/Q6Dz2fFj2M31FkVpiVDVM03K9uDNr35SbGxclJq/GzPhqXeS88H+MAXjH6X3g6wciHZNNng5ZPPC0f9Rr7Pv17tTNgo/sLEy92duAA4c3tFB8bQm/x+pekLHGWHnVhLH8xDmsGd6LFpLuiF4sz/FQ4WGGCBiTkjFW/i6FtWcpN/u1A4+AxcfMSdVibIPjfIc6RiWnAsACwwwdYj4jLy3GdlSWxMQJquYGuFooiSOPvYCmW/g21Q/t0K9XH0tXFMZbss8nVKYsfRhSsBQypc0JYkzl62UeYp2LjkFsd2ysspgRHEEGxc8q6lWCU53QGlBdtAzyG5KI60QoAFJtgGzQJ6DslNKwBYYILtsgjNAnp+H5keXBQYYIGJby7AnepVxUodkjvo5DuHLxgKrXa7mwsAgNNvoRr0/D47cTKtvlq4tW4vALfXcDDBSLtlDgVwQf5n03fbuPtJ42/LLeEvKdWYGdgZAAAAAElFTkSuQmCC",ht=jt.icon({iconUrl:bt,shadowUrl:bt,iconSize:[24,24],shadowSize:[24,24],iconAnchor:[12,12],shadowAnchor:[12,12],popupAnchor:[-3,-76]}),pt=function(e){var t=e.initialPoint,n=e.startPoint,a=e.range,c=e.checkpoints,r=e.onDrag,i=e.onClick,o=e.onChange,s=Object(l.useRef)(null),d=Object(l.useRef)(null),u=Object(l.useState)(!1),j=Object(f.a)(u,2),b=j[0],h=j[1];return Object(l.useEffect)((function(){var e=jt.map("mapid").setView(t,13);return jt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors,',maxZoom:18,id:"osm/streets",tileSize:512,zoomOffset:-1}).addTo(e),s.current=e,function(){e.off(),e.remove()}}),[t]),Object(l.useEffect)((function(){var e=s.current;if(e){var t=function(e){var t=e.latlng;i(t)};return e.on("click",t),function(){e.off("click",t)}}}),[i,s]),Object(l.useEffect)((function(){var e=s.current;if(n&&e){var t=jt.circle(n,{color:"red",opacity:.5,fillColor:"#fff",fillOpacity:.2,radius:500}).addTo(e),a=jt.marker(n,{draggable:!0});return a.on("dragstart",(function(e){h(!0)})),a.on("dragend",(function(e){h(!1)})),a.on("dragend",(function(e){var t=e.target.getLatLng();r(t)})),a.on("drag",(function(e){var n=e.target.getLatLng();t.setLatLng(n)})),e.addLayer(a),d.current=t,function(){d.current=null,e.removeLayer(a),e.removeLayer(t)}}}),[n,s,r]),Object(l.useEffect)((function(){d.current&&d.current.setRadius(a)}),[a,d]),Object(l.useEffect)((function(){var e;if(s.current&&d.current&&c&&!b){var t=null!==(e=null===c||void 0===c?void 0:c.map((function(e,t){return jt.marker([e.lat,e.lng],{draggable:!0,icon:ht}).bindTooltip("".concat(t+1),{permanent:!0,interactive:!1,className:"checkpoint-label",direction:"right"})})))&&void 0!==e?e:[];return t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.addLayer(e)})),t.forEach((function(e){e.on("dragend",(function(e){var n=t.map((function(e){return e.getLatLng()}));o(n)}))})),function(){t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.removeLayer(e)}))}}}),[c,d,s,b,o]),Object(oe.jsx)("div",{id:"mapid",style:{height:"100%"}})},ft=Object(X.a)(Ze||(Ze=Object(J.a)(["\n  query getVirtualPoints ($input: PointsNearbyInput!) {\n    pointsNearby(input: $input) {\n      points {\n        lat\n        lng\n      }\n    }\n  }\n"]))),Ot=Object(X.a)(et||(et=Object(J.a)(["\n  mutation CreateVirtualChallenge(\n    $input: CreateVirtualChallengeInput!\n  ) {\n    createVirtualChallenge(\n      input: $input\n    ) {\n      success\n      virtualChallenge {\n        id\n        name\n        checkpoints {\n          points {\n            lat\n            lng\n          }\n          totalCount\n        }\n      }\n    }\n  }\n"]))),vt=function(){var e=Object(l.useState)([]),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(ut.a)(ft,{fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0}),r=Object(f.a)(c,2),i=r[0],o=r[1],s=o.loading,d=o.data,u=Object(Y.a)(Ot),j=Object(f.a)(u,1)[0],b=Object(l.useState)(null),h=Object(f.a)(b,2),p=h[0],O=h[1],v=Object(l.useMemo)((function(){return[54.372158,18.638306]}),[]),x=Object(l.useState)(500),m=Object(f.a)(x,2),g=m[0],y=m[1],k=Object(l.useCallback)((function(e){O([e.lat,e.lng])}),[O]),w=null!==p,C=Object(l.useCallback)((function(e){w||O([e.lat,e.lng])}),[w,O]),A=Object(l.useCallback)((function(e){a(e)}),[a]),S=Object(l.useCallback)((function(){j({variables:{input:{name:"Test",checkpoints:n.map((function(e){return{lat:e.lat.toString(),lng:e.lng.toString()}}))}}})}),[n,j]);return Object(l.useEffect)((function(){p&&i({variables:{input:{start:{lat:p[0].toString(),lng:p[1].toString()},radius:g,count:12}}})}),[i,g,p]),Object(l.useEffect)((function(){a(!s&&d?d.pointsNearby.points.map((function(e){var t=e.lat,n=e.lng;return{lat:parseFloat(t),lng:parseFloat(n)}})):[])}),[s,d]),Object(oe.jsxs)("div",{children:[Object(oe.jsxs)("div",{style:{height:200},children:[Object(oe.jsx)(dt.a,{value:g,onChange:function(e,t){y(Array.isArray(t)?t[0]:t)},min:100,max:2e3,"aria-labelledby":"continuous-slider"}),Object(oe.jsx)("br",{}),Object(oe.jsx)(Ee.a,{onClick:S,children:"Create"})]}),Object(oe.jsx)("div",{style:{position:"fixed",bottom:12,left:12,right:12,top:300},children:Object(oe.jsx)(pt,{initialPoint:v,startPoint:p,range:g,checkpoints:n,onDrag:k,onClick:C,onChange:A})})]})},xt=Object(X.a)(tt||(tt=Object(J.a)(["\n  query getVirtualChallenges {\n    virtualChallenges {\n      nodes {\n        id\n        name\n        createdAt: created_at\n        checkpoints {\n          totalCount\n          points {\n            lat\n            lng\n          }\n        }\n      }\n    }\n  }\n"]))),mt=n(181),gt=n.n(mt),yt=function(){var e=je(),t=Object(q.a)(xt,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),n=t.data,a=t.loading,c=be();return n?Object(oe.jsxs)("div",{children:[Object(oe.jsx)(_.a,{px:1,py:2,children:Object(oe.jsx)(B.a,{"aria-label":"breadcrumb",children:Object(oe.jsxs)(g.a,{color:"textPrimary",className:c.link,children:[Object(oe.jsx)(A.a,{className:c.icon}),"Virtual Challenges"]})})}),Object(oe.jsx)(fe,{active:a}),Object(oe.jsx)(z.a,{children:n.virtualChallenges.nodes.map((function(e){return Object(oe.jsx)(R.a,{button:!0,component:S.b,to:"/virtual-challenges/".concat(e.id),children:Object(oe.jsx)(gt.a,{primary:e.name,secondary:Object(K.a)(new Date(e.createdAt),"dd/MM/yyyy")})})}))})]}):Object(oe.jsx)("div",{children:"Loading"})},kt=Object(X.a)(nt||(nt=Object(J.a)(["\n  query getVirtualChallenge($id: Int!) {\n    virtualChallenge(id: $id) {\n      id\n      name\n      createdAt: created_at\n      checkpoints {\n        totalCount\n        points {\n          lat\n          lng\n        }\n      }\n    }\n  }\n"]))),wt=Object(X.a)(at||(at=Object(J.a)(["\n  mutation EnrollVirtualChallenge($id: Int!) {\n    enrollVirtualChallenge(id: $id) {\n      success\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),Ct=function(){var e=je(),t=be(),n=Object(E.f)(),a=Object(E.h)().id,c=Object(q.a)(kt,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0,variables:{id:parseInt(a,10)}}).data,r=Object(Y.a)(wt,{refetchQueries:[{query:Z}],awaitRefetchQueries:!0,onCompleted:function(e){n.push("/events/".concat(e.enrollVirtualChallenge.event.id))},variables:{id:parseInt(a,10)}}),i=Object(f.a)(r,1)[0],o=null===c||void 0===c?void 0:c.virtualChallenge;return o?Object(oe.jsxs)("div",{children:[Object(oe.jsx)(_.a,{px:1,py:2,children:Object(oe.jsxs)(B.a,{"aria-label":"breadcrumb",children:[Object(oe.jsxs)(y.a,{color:"inherit",component:S.b,to:"/virtual-challenges",className:t.link,children:[Object(oe.jsx)(A.a,{className:t.icon}),"Virtual Challenges"]}),Object(oe.jsx)(g.a,{color:"textPrimary",children:o.name})]})}),Object(oe.jsx)(Ee.a,{onClick:function(){return i()},children:"Join"})]}):Object(oe.jsx)("div",{children:"NOT FOUND"})},At=n(348),St=n(182),Et=n.n(St),It=Object(l.createContext)(null),Nt=function(){var e=Object(l.useContext)(It),t=Object(l.useState)(!1),n=Object(f.a)(t,2),a=n[0],c=n[1],r=Object(l.useState)(null),i=Object(f.a)(r,2),o=i[0],s=i[1];Object(l.useEffect)((function(){if(e){var t=function(e){s(e)};return e.onUpdate(t),function(){e.offUpdate(t)}}}),[e]);var u=function(){s(null)};return Object(oe.jsx)(At.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:Boolean(o),onClose:u,message:"A new version of the app is available!",action:Object(oe.jsxs)(d.a.Fragment,{children:[Object(oe.jsx)(Ee.a,{color:"secondary",size:"small",onClick:function(){if(o){c(!0);var e=o.waiting;e&&(e.postMessage({type:"SKIP_WAITING"}),e.addEventListener("statechange",(function(e){var t=e.target?e.target:null;"activated"===(null===t||void 0===t?void 0:t.state)&&window.location.reload()})))}},disabled:a,children:"RELOAD"}),Object(oe.jsx)(k.a,{size:"small","aria-label":"close",color:"inherit",onClick:u,children:Object(oe.jsx)(Et.a,{fontSize:"small"})})]})})},Pt=n(146),Wt=function(){return Object(I.a)({uri:"https://woodtime-api.ertrzyiks.me/woodtime"})},Lt=Object(O.a)((function(e){return Object(v.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},loaderWrapper:{alignItems:"center",width:"100%",height:"100%",justifyContent:"center",display:"flex"}})}));var Rt=function(){var e=Object(l.useState)(null),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Lt();return Object(l.useEffect)((function(){function e(){return(e=Object(p.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new N.a,e.next=3,Object(Pt.b)({cache:t,storage:new Pt.a(window.localStorage)});case 3:a(new P.a({cache:t,link:Wt()}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch(console.error)}),[a]),Object(oe.jsxs)(S.a,{basename:"",children:[Object(oe.jsx)(Nt,{}),Object(oe.jsxs)(ue,{children:[Object(oe.jsx)(x.a,{position:"static",children:Object(oe.jsxs)(m.a,{children:[Object(oe.jsx)(g.a,{variant:"h6",className:c.title,children:Object(oe.jsx)(y.a,{component:S.b,to:"/",color:"inherit",children:"Woodtime"})}),Object(oe.jsx)(k.a,{component:S.b,to:"/virtual-challenges",color:"inherit","aria-label":"Browse virtual challenges",children:Object(oe.jsx)(A.a,{})})]})}),n?Object(oe.jsx)(W.a,{client:n,children:Object(oe.jsxs)(E.c,{children:[Object(oe.jsx)(E.a,{path:"/",exact:!0,children:Object(oe.jsx)(xe,{})}),Object(oe.jsxs)(E.a,{path:"/events/new",exact:!0,children:[Object(oe.jsx)(xe,{}),Object(oe.jsx)(Pe,{})]}),Object(oe.jsx)(E.a,{path:"/events/:id",exact:!0,children:Object(oe.jsx)(Ue,{})}),Object(oe.jsx)(E.a,{path:"/events/:id/add-checkpoint",exact:!0,children:Object(oe.jsx)(lt,{})}),Object(oe.jsx)(E.a,{path:"/virtual-challenges",exact:!0,children:Object(oe.jsx)(yt,{})}),Object(oe.jsx)(E.a,{path:"/virtual-challenges/new",exact:!0,children:Object(oe.jsx)(vt,{})}),Object(oe.jsx)(E.a,{path:"/virtual-challenges/:id",exact:!0,children:Object(oe.jsx)(Ct,{})})]})}):Object(oe.jsx)("div",{className:c.loaderWrapper,children:Object(oe.jsx)(w.a,{})})]})]})},Dt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _t(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Bt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,354)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))},zt=[],Ft=[],Gt=function(e){var t=e.children,n={onSuccess:function(e){return zt.push(e)},offSuccess:function(e){return zt.filter((function(t){return t!==e}))},onUpdate:function(e){return Ft.push(e)},offUpdate:function(e){return Ft.filter((function(t){return t!==e}))}};return Object(oe.jsx)(It.Provider,{value:n,children:t})};j.a.render(Object(oe.jsx)(d.a.StrictMode,{children:Object(oe.jsx)(Gt,{children:Object(oe.jsx)(Rt,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Dt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):_t(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):_t(t,e)}))}}({onUpdate:function(e){Ft.forEach((function(t){return t(e)}))},onSuccess:function(){zt.forEach((function(e){return e()}))}}),Bt()}},[[274,1,2]]]);
//# sourceMappingURL=main.520532f8.chunk.js.map