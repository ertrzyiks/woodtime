(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{193:function(e,t,n){},228:function(e,t,n){"use strict";n.r(t);var c,a,i,r,o,s,l=n(0),d=n.n(l),j=n(17),u=n.n(j),b=(n(193),n(134)),h=n.n(b),p=n(155),O=n(14),x=n(267),f=n(269),v=n(292),m=n(293),g=n(294),k=n(295),y=n(55),C=n(290),w=n(297),A=n(83),S=n.n(A),I=n(70),E=n.n(I),N=n(25),P=n(26),_=n(167),L=n(300),W=n(299),B=n(296),R=n(168),z=n(272),F=n(273),Q=n(307),D=n(305),$=n(271),G=n(237),V=n(280),T=n(82),U=n.n(T),q=n(120),H=n.n(q),K=n(162),M=n.n(K),Y=n(166),J=n(275),X=n(310),Z=n(22),ee=n(23),te=Object(ee.a)(c||(c=Object(Z.a)(["\n  query getEvents {\n    events {\n      id\n      name\n      checkpoint_count\n      created_at\n    }\n  }\n"]))),ne=Object(ee.a)(a||(a=Object(Z.a)(["\n  query getEvent($id: Int!) {\n    event(id: $id) {\n      id\n      name\n      type\n      checkpoint_count\n      virtual_challenge {\n        id\n      }\n      checkpoints {\n        id\n        cp_id\n        cp_code\n        event_id\n        skipped\n        skip_reason\n      }\n    }\n  }\n"]))),ce=Object(ee.a)(i||(i=Object(Z.a)(["\n  mutation CreateEvent($name: String!, $checkpointCount: Int!, $type: Int!) {\n    createEvent(name: $name, checkpointCount: $checkpointCount, type: $type) {\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),ae=Object(ee.a)(r||(r=Object(Z.a)(["\n  mutation CreateCheckpoint(\n    $eventId: Int!\n    $cpId: Int!\n    $cpCode: String\n    $skipped: Boolean\n    $skipReason: String\n  ) {\n    createCheckpoint(\n      event_id: $eventId\n      cp_id: $cpId\n      cp_code: $cpCode\n      skipped: $skipped\n      skip_reason: $skipReason\n    ) {\n      checkpoint {\n        id\n        event_id\n        cp_id\n        cp_code\n        skipped\n        skip_reason\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),ie=Object(ee.a)(o||(o=Object(Z.a)(["\n  mutation DeleteEvent($id: Int!) {\n    deleteEvent(id: $id) {\n      id\n    }\n  }\n"]))),re=Object(ee.a)(s||(s=Object(Z.a)(["\n  mutation DeleteCheckpoint($id: Int!) {\n    deleteCheckpoint(id: $id) {\n      id\n    }\n  }\n"]))),oe=n(304),se=n(270),le=n(2),de=Object(x.a)((function(e){return Object(f.a)({listWrapper:{padding:10}})})),je=function(e){var t=de();return Object(le.jsxs)(oe.a,{"aria-labelledby":"simple-checklist-title",open:!0,onClose:e.handleClose,children:[Object(le.jsx)(se.a,{id:"simple-checklist-title",children:"Rzeczy do zabrania"}),Object(le.jsx)($.a,{className:t.listWrapper,children:["4 kanapki","dwa bidony wody","kubek Kuby","jab\u0142ko w kawa\u0142kach","banan","ciastka","pampersy","chusteczki mokre","worek na \u015bmieci","chusteczki zwyk\u0142e","p\u0119seta","octenisept","\u017cel do dezynfekcji"].map((function(e,t){return Object(le.jsx)(z.a,{dense:!0,children:Object(le.jsx)(F.a,{primary:e,primaryTypographyProps:{variant:"body1"}})},t)}))})]})},ue=d.a.createContext(!1),be=function(e){var t=e.children,n=Object(l.useState)(null),c=Object(O.a)(n,2),a=c[0],i=c[1],r=Object(l.useState)(!0),o=Object(O.a)(r,2),s=o[0],d=o[1],j=Object(N.g)();return Object(l.useEffect)((function(){a?a!==j.pathname&&d(!1):i(j.pathname)}),[a,j.pathname,s,d]),Object(le.jsx)(ue.Provider,{value:(!a||a===j.pathname)&&s,children:t})};function he(){return Object(l.useContext)(ue)}var pe=Object(x.a)((function(e){return Object(f.a)({link:{display:"flex"},icon:{marginRight:e.spacing(.5),width:20,height:20}})})),Oe=n(274),xe=Object(x.a)((function(e){return Object(f.a)({root:{height:4}})})),fe=function(e){var t=e.active,n=xe();return Object(le.jsx)("div",{className:n.root,children:t&&Object(le.jsx)(Oe.a,{color:"secondary"})})},ve=function(e){var t=e.id,n=e.name,c=e.createdAt;return Object(le.jsx)(z.a,{button:!0,component:P.b,to:"/events/".concat(t),children:Object(le.jsx)(F.a,{primary:n,secondary:Object(Y.a)(new Date(c),"dd/MM/yyyy")})})},me=Object(x.a)((function(e){return Object(f.a)({wrapper:{display:"flex",width:"100%"},deleteIcon:{},icons:{display:"flex",justifyContent:"space-between"},listWrapper:{},addEventButton:{position:"absolute",right:"1em",bottom:"5em"}})})),ge=function(){var e=he(),t=Object(J.a)(te,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),n=t.loading,c=t.error,a=t.data,i=Object(l.useState)(!1),r=Object(O.a)(i,2),o=r[0],s=r[1],d=Object(X.a)(ie,{refetchQueries:["getEvents"],awaitRefetchQueries:!0}),j=Object(O.a)(d,1)[0],u=me(),b=pe();return n&&!a?Object(le.jsx)("p",{children:"Loading..."}):c?Object(le.jsx)("p",{children:"Error :("}):Object(le.jsxs)("div",{className:u.listWrapper,children:[Object(le.jsx)(Q.a,{px:1,py:2,children:Object(le.jsx)(D.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(y.a,{color:"textPrimary",className:b.link,children:[Object(le.jsx)(E.a,{className:b.icon}),"Events"]})})}),Object(le.jsx)(fe,{active:n}),c&&Object(le.jsx)("p",{children:"Error :("}),Object(le.jsx)($.a,{children:Object(R.a)(a.events).sort((function(e,t){return t.id-e.id})).map((function(e){var t=e.id,n=e.name,c=e.created_at;return Object(le.jsxs)("div",{className:u.wrapper,children:[Object(le.jsx)(ve,{id:t,name:n,createdAt:c}),Object(le.jsxs)("div",{className:u.icons,children:[Object(le.jsx)(G.a,{"aria-label":"checklist",onClick:function(){s(!0)},children:Object(le.jsx)(M.a,{})}),Object(le.jsx)(G.a,{"aria-label":"delete",onClick:function(){return j({variables:{id:t}})},children:Object(le.jsx)(H.a,{})})]})]},t)}))}),o&&Object(le.jsx)(je,{handleClose:function(){s(!1)}}),Object(le.jsx)(V.a,{className:u.addEventButton,color:"primary","aria-label":"add",component:P.b,to:"/events/new",children:Object(le.jsx)(U.a,{})})]})},ke=n(281),ye=n(298),Ce=n(282),we=n(283),Ae=n(308),Se=n(285),Ie=n(302),Ee=n(286),Ne=n(287),Pe=n(48),_e=Object(x.a)((function(e){return Object(f.a)({radioGroupWrapper:{paddingTop:25,paddingBottom:10},title:{paddingBottom:0},radioLabel:{fontSize:"0.6rem"}})})),Le=function(){var e=Object(l.useState)(""),t=Object(O.a)(e,2),n=t[0],c=t[1],a=Object(l.useState)(""),i=Object(O.a)(a,2),r=i[0],o=i[1],s=Object(l.useState)("score"),d=Object(O.a)(s,2),j=d[0],u=d[1],b=Object(N.f)(),h=Object(X.a)(ce,{refetchQueries:[{query:te}],awaitRefetchQueries:!0,onCompleted:function(e){b.push("/events/".concat(e.createEvent.event.id))}}),p=Object(O.a)(h,1)[0],x=_e(),f=function(){b.push("/")};return Object(le.jsxs)(oe.a,{open:!0,keepMounted:!0,onClose:f,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(le.jsx)(se.a,{id:"alert-dialog-slide-title",className:x.title,children:"Create a new event"}),Object(le.jsx)(Pe.b,{onSubmit:function(){var e="score"===j?1:2;return p({variables:{name:n,checkpointCount:parseInt(r,10),type:e}})},render:function(e){var t=e.handleSubmit;return Object(le.jsxs)("form",{onSubmit:t,children:[Object(le.jsxs)(ke.a,{children:[Object(le.jsx)(Pe.a,{name:"name",render:function(e){e.input;var t=e.meta;return Object(le.jsxs)("div",{children:[Object(le.jsx)(ye.a,{id:"standard-basic",label:"Name",required:!0,autoComplete:"off",onChange:function(e){return c(e.target.value)}}),t.touched&&t.error&&Object(le.jsx)("span",{children:t.error})]})}}),Object(le.jsx)(Pe.a,{name:"points",render:function(e){e.input;var t=e.meta;return Object(le.jsxs)("div",{children:[Object(le.jsx)(ye.a,{id:"standard-basic",label:"Points",required:!0,autoComplete:"off",onChange:function(e){return o(e.target.value)}}),t.touched&&t.error&&Object(le.jsx)("span",{children:t.error})]})}}),Object(le.jsx)(Pe.a,{name:"type",render:function(){return Object(le.jsx)("div",{className:x.radioGroupWrapper,children:Object(le.jsxs)(Ce.a,{component:"fieldset",children:[Object(le.jsx)(we.a,{component:"legend",children:"Type"}),Object(le.jsxs)(Ae.a,{"aria-label":"type",name:"type",value:j,onChange:function(e){return u(e.target.value)},children:[Object(le.jsx)(Se.a,{value:"score",control:Object(le.jsx)(Ie.a,{size:"small"}),label:Object(le.jsx)(y.a,{variant:"body2",children:"Scorelauf"})}),Object(le.jsx)(Se.a,{value:"classic",control:Object(le.jsx)(Ie.a,{size:"small"}),label:Object(le.jsx)(y.a,{variant:"body2",children:"Classic"})})]})]})})}})]}),Object(le.jsxs)(Ee.a,{children:[Object(le.jsx)(Ne.a,{variant:"contained",color:"primary",type:"submit",children:"Create"}),Object(le.jsx)(Ne.a,{onClick:f,color:"primary",children:"Cancel"})]})]})}})]})},We=n(163),Be=n(288),Re=n(232),ze=n(49),Fe=n(170),Qe=["current","max"];var De,$e,Ge,Ve,Te,Ue=function(e){var t=e.current,n=e.max,c=Object(Fe.a)(e,Qe),a=100*t/n;return Object(le.jsxs)(Q.a,{display:"flex",alignItems:"center",children:[Object(le.jsx)(Q.a,{width:"100%",mr:1,children:Object(le.jsx)(Oe.a,Object(ze.a)(Object(ze.a)({variant:"determinate"},c),{},{value:a}))}),Object(le.jsx)(Q.a,{minWidth:35,children:Object(le.jsxs)(y.a,{variant:"body2",color:"textSecondary",children:[t,"/",n]})})]})},qe=function(e){var t=e.scoredIds,n=e.max,c=Array(n).fill(n).map((function(e,t){return 1+t})).filter((function(e){return!t.includes(e)}));return 0===t.length||t.length===n?null:Object(le.jsxs)(Q.a,{mt:3,children:[Object(le.jsx)(Q.a,{minWidth:35,ml:1,mb:1,children:Object(le.jsx)(y.a,{children:"Missing:"})}),Object(le.jsx)(Q.a,{display:"flex",alignItems:"center",children:Object(le.jsx)(Q.a,{width:"100%",ml:1,children:c.join(", ")})})]})},He=Object(x.a)((function(e){return Object(f.a)({wrapper:{width:"100%"},header:{padding:10,paddingBottom:2,backgroundColor:"#c5cae9"},content:{border:"1px solid #c5cae9",width:"100%",paddingLeft:10,paddingRight:10,paddingBottom:10,padding:10,boxSizing:"border-box"},deleteIcon:{position:"absolute",top:-3,right:-5}})})),Ke=function(e){var t,n=e.checkpoint,c=Object(X.a)(re,{refetchQueries:["getEvent"],awaitRefetchQueries:!0}),a=Object(O.a)(c,1)[0],i=He();return Object(le.jsxs)("div",{style:{display:"flex",flexDirection:"row",position:"relative"},children:[Object(le.jsxs)("div",{className:i.wrapper,children:[Object(le.jsx)("div",{className:i.header,children:Object(le.jsx)(y.a,{variant:"button",color:"textSecondary",children:n.cp_id})}),Object(le.jsx)("div",{className:i.content,children:Object(le.jsx)(y.a,{variant:"subtitle1",children:Object(le.jsx)("span",{children:n.skipped?"skipped":null===(t=n.cp_code)||void 0===t?void 0:t.toUpperCase()})})})]}),Object(le.jsx)("div",{className:i.deleteIcon,children:Object(le.jsx)(G.a,{"aria-label":"delete",onClick:function(){return e=n.id,a({variables:{id:e}});var e},children:Object(le.jsx)(H.a,{})})})]})},Me=function(e){var t=e.checkpoints,n=e.max,c=Array(n).fill(n).map((function(e,t){return 1+t})).map((function(e){var n=t.find((function(t){return t.cp_id===e}));return!n||n.skipped?"...":n.cp_code}));return Object(le.jsxs)(Q.a,{mt:3,children:[Object(le.jsx)(Q.a,{minWidth:35,ml:1,mb:1,children:Object(le.jsx)(y.a,{variant:"h6",children:"Solution:"})}),Object(le.jsx)(Q.a,{display:"flex",alignItems:"center",children:Object(le.jsx)(Q.a,{width:"100%",ml:1,children:c.join(" ")})})]})},Ye=Object(x.a)((function(e){return Object(f.a)({root:{flexGrow:1,padding:20},paper:{width:80},item:{padding:5},control:{padding:e.spacing(2)},addCheckpointButton:{position:"absolute",right:"1em",bottom:"1em"}})})),Je=function(e){var t=e.event,n=e.newCheckpointPath,c=t.checkpoints,a=d.a.useState(2),i=Object(O.a)(a,1)[0],r=Ye();return Object(le.jsxs)(Q.a,{m:1,children:[Object(le.jsx)(y.a,{variant:"h6",children:t.name}),Object(le.jsx)(Ue,{current:c.length,max:t.checkpoint_count}),c.length>0&&Object(le.jsx)(Be.a,{container:!0,className:r.root,spacing:2,children:Object(le.jsx)(Be.a,{item:!0,xs:12,children:Object(le.jsx)(Be.a,{container:!0,justify:"flex-start",spacing:i,children:c.map((function(e){return Object(le.jsx)(Be.a,{item:!0,className:r.item,children:Object(le.jsx)(Re.a,{className:r.paper,children:Object(le.jsx)(Ke,{checkpoint:e,eventId:t.id})})},e.cp_id)}))})})}),Object(le.jsx)(V.a,{className:r.addCheckpointButton,color:"primary","aria-label":"add",component:P.b,to:n,children:Object(le.jsx)(U.a,{})}),Object(le.jsx)(qe,{scoredIds:c.map((function(e){return e.cp_id})),max:t.checkpoint_count}),Object(le.jsx)(Me,{checkpoints:c,max:t.checkpoint_count})]})},Xe=function(e){var t=e.event,n=(e.virtualChallenge,e.newCheckpointPath,t.checkpoints);return Object(le.jsx)("div",{children:Object(le.jsx)(Ue,{current:n.length,max:t.checkpoint_count})})},Ze=n(289),et=n(303),tt=Object(x.a)((function(e){return Object(f.a)({skippedText:{fontStyle:"italic"}})})),nt=function(e){var t=e.id,n=e.checkpoint,c=e.eventId,a="checkbox-list-label-".concat(t),i=Object(N.f)(),r=Object(X.a)(ae,{refetchQueries:["getEvent"],awaitRefetchQueries:!0,onCompleted:function(e){i.push("/events/".concat(e.createCheckpoint.checkpoint.event_id))}}),o=Object(O.a)(r,2),s=o[0],l=o[1],d=l.loading,j=l.error,u=Object(X.a)(re,{refetchQueries:["getEvent"],awaitRefetchQueries:!0}),b=Object(O.a)(u,1)[0],h=tt();if(d)return Object(le.jsx)("p",{children:"Loading..."});if(j)return Object(le.jsx)("p",{children:"Error :("});var p=!n&&Object(le.jsx)(Ne.a,{variant:"contained",onClick:function(e){return function(e,t){e.stopPropagation();try{return s({variables:{eventId:c,cpId:t,cpCode:void 0,skipped:!0,skipReason:void 0}})}catch(n){throw n}}(e,t)},children:"Skip"}),x=n&&n.skipped&&Object(le.jsx)("span",{className:h.skippedText,children:"skipped"});return Object(le.jsxs)(z.a,{role:void 0,dense:!0,button:!0,onClick:function(){return function(e){if(n)return b({variables:{id:n.id}});try{return s({variables:{eventId:c,cpId:e,cpCode:void 0,skipped:!1,skipReason:void 0}})}catch(t){throw t}}(t)},children:[Object(le.jsx)(Ze.a,{children:Object(le.jsx)(et.a,{edge:"start",checked:null!=n,tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":a}})}),Object(le.jsx)(F.a,{id:a,primary:t}),x,p]},t)},ct=function(e){var t=e.event,n=t.id,c=t.name,a=t.checkpoints,i=t.checkpoint_count,r=Array(i).fill(i).map((function(e,t){return 1+t}));return Object(le.jsxs)(Q.a,{m:1,children:[Object(le.jsx)(y.a,{variant:"h6",children:c}),Object(le.jsx)(Ue,{current:a.length,max:i}),r.map((function(e){var t=a.find((function(t){return t.cp_id===e}));return Object(le.jsx)(nt,{id:e,checkpoint:t,eventId:n},e)})),Object(le.jsx)(qe,{scoredIds:a.map((function(e){return e.cp_id})),max:t.checkpoint_count})]})},at=1,it=function(e){var t=e.children,n=e.width,c=e.height;return Object(le.jsx)(We.a,{speed:2,width:n,height:c,viewBox:"0 0 ".concat(n," ").concat(c),backgroundColor:"#eeeeee",foregroundColor:"#cccccc",children:t})},rt=function(){var e=Object(N.h)().id,t=pe(),n=he(),c=Object(J.a)(ne,{variables:{id:parseInt(e,10)},fetchPolicy:n?"cache-and-network":void 0,nextFetchPolicy:n?"cache-first":void 0}),a=c.loading,i=c.error,r=c.data,o=null===r||void 0===r?void 0:r.event;if(a&&!r)return Object(le.jsxs)("div",{children:[Object(le.jsx)(Q.a,{px:1,py:2,children:Object(le.jsx)(D.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(C.a,{color:"inherit",component:P.b,to:"/",className:t.link,children:[Object(le.jsx)(E.a,{className:t.icon}),"Events"]})})}),Object(le.jsx)(Q.a,{px:1,py:2,children:Object(le.jsxs)(it,{width:300,height:500,children:[Object(le.jsx)("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"45",height:"12"}),Object(le.jsx)("rect",{x:"0",y:"20",rx:"3",ry:"3",width:"250",height:"3"}),Object(le.jsx)("rect",{x:"30",y:"40",rx:"3",ry:"3",width:"80",height:"80"}),Object(le.jsx)("rect",{x:"130",y:"40",rx:"3",ry:"3",width:"80",height:"80"}),Object(le.jsx)("rect",{x:"0",y:"190",rx:"3",ry:"3",width:"45",height:"12"}),Object(le.jsx)("rect",{x:"0",y:"220",rx:"3",ry:"3",width:"100",height:"10"}),Object(le.jsx)("rect",{x:"0",y:"240",rx:"3",ry:"3",width:"100",height:"10"}),Object(le.jsx)("rect",{x:"0",y:"260",rx:"3",ry:"3",width:"100",height:"10"})]})})]});var s=o.type===at?Object(le.jsx)(Je,{event:o,newCheckpointPath:"/events/".concat(o.id,"/add-checkpoint")}):Object(le.jsx)(ct,{event:o});return Object(le.jsxs)("div",{children:[Object(le.jsx)(Q.a,{px:1,py:2,children:Object(le.jsxs)(D.a,{"aria-label":"breadcrumb",children:[Object(le.jsxs)(C.a,{color:"inherit",component:P.b,to:"/",className:t.link,children:[Object(le.jsx)(E.a,{className:t.icon}),"Events"]}),Object(le.jsx)(y.a,{color:"textPrimary",children:o.name})]})}),Object(le.jsx)(fe,{active:a}),i&&Object(le.jsx)("p",{children:"Error :("}),3===o.type&&o.virtual_challenge?Object(le.jsx)(Xe,{event:o,virtualChallenge:o.virtual_challenge,newCheckpointPath:"/events/".concat(o.id,"/add-checkpoint")}):s]})},ot=n(95),st=n(68),lt=Object(x.a)((function(e){return Object(f.a)({margin:{margin:e.spacing(1)}})})),dt=function(){var e=Object(N.h)().id,t=Object(N.f)(),n=Object(X.a)(ae,{refetchQueries:[{query:ne,variables:{id:parseInt(e,10)}}],awaitRefetchQueries:!0,onCompleted:function(e){t.push("/events/".concat(e.createCheckpoint.checkpoint.event_id))}}),c=Object(O.a)(n,2),a=c[0],i=c[1],r=i.loading,o=i.error,s=lt();return r?Object(le.jsx)("p",{children:"Loading..."}):o?Object(le.jsx)("p",{children:"Error :("}):Object(le.jsx)(Pe.b,{onSubmit:function(t){try{return a({variables:{eventId:parseInt(e,10),cpId:parseInt(t.cpId,10),cpCode:t.cpCode,skipped:t.skipped,skipReason:t.skipReason}})}catch(n){return n?n.message&&n.message.startsWith("Checkpoint")?{id:"Id already taken"}:Object(ot.a)({},st.a,n.message||n):Object(ot.a)({},st.a,"Something went wrong")}},initialValues:{skipped:!1},render:function(e){var t=e.values,n=e.submitError,c=e.handleSubmit;return t.skipped&&delete t.cpCode,Object(le.jsxs)("form",{onSubmit:c,children:[n&&Object(le.jsx)("div",{className:"error",children:n}),Object(le.jsx)(Pe.a,{name:"cpId",render:function(e){var t=e.input,n=e.meta;return Object(le.jsxs)("div",{className:s.margin,children:[Object(le.jsx)(ye.a,Object(ze.a)(Object(ze.a)({},t),{},{label:"Id",required:!0,autoComplete:"off"})),n.touched&&(n.error||n.submitError)&&Object(le.jsx)("span",{children:n.error||n.submitError})]})}}),Object(le.jsx)(Pe.a,{name:"cpCode",render:function(e){var n=e.input,c=e.meta;return Object(le.jsxs)("div",{className:s.margin,children:[Object(le.jsx)(ye.a,Object(ze.a)(Object(ze.a)({},n),{},{label:"Code",required:!t.skipped,disabled:t.skipped,autoComplete:"off"})),c.touched&&(c.error||c.submitError)&&Object(le.jsx)("span",{children:c.error||c.submitError})]})}}),Object(le.jsx)(Pe.a,{name:"skipped",type:"checkbox",render:function(e){var t=e.input;e.meta;return Object(le.jsx)(Q.a,{display:"flex",alignItems:"center",ml:1,children:Object(le.jsx)(Se.a,{control:Object(le.jsx)(et.a,Object(ze.a)(Object(ze.a)({},t),{},{checked:t.value,name:"skipped",color:"primary"})),label:"Skip"})})}}),Object(le.jsx)(Ne.a,{variant:"contained",color:"primary",type:"submit",children:"Submit"})]})}})},jt=n(309),ut=n(291),bt=n(74),ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADB/VeXAAACH0lEQVRIDbWWPU8bQRCGZ/bsJHKDROIiJh0dFESyRRKlpggWWPkNFhUSLSWiRK6pIn6DfSCSInWUgBwpFEnnKkCBAxIUFnDcDvOusGXZTrJHLltYt3czz+zHzDtm+sM4ffH+WRxfV4i4TCSTJFRw5kzH+q6l73aD4EH4eG/+8HcYHvWh/TosyKWsC/NbFtkxFIQSmB+SyylY0Z1OgSmatjEtqs2C2tT5Ea/lP1Xc937mUIB2KVy0RFss9C5DuY3xr3Pn/Q6Dz2fFj2M31FkVpiVDVM03K9uDNr35SbGxclJq/GzPhqXeS88H+MAXjH6X3g6wciHZNNng5ZPPC0f9Rr7Pv17tTNgo/sLEy92duAA4c3tFB8bQm/x+pekLHGWHnVhLH8xDmsGd6LFpLuiF4sz/FQ4WGGCBiTkjFW/i6FtWcpN/u1A4+AxcfMSdVibIPjfIc6RiWnAsACwwwdYj4jLy3GdlSWxMQJquYGuFooiSOPvYCmW/g21Q/t0K9XH0tXFMZbss8nVKYsfRhSsBQypc0JYkzl62UeYp2LjkFsd2ysspgRHEEGxc8q6lWCU53QGlBdtAzyG5KI60QoAFJtgGzQJ6DslNKwBYYILtsgjNAnp+H5keXBQYYIGJby7AnepVxUodkjvo5DuHLxgKrXa7mwsAgNNvoRr0/D47cTKtvlq4tW4vALfXcDDBSLtlDgVwQf5n03fbuPtJ42/LLeEvKdWYGdgZAAAAAElFTkSuQmCC",pt=bt.icon({iconUrl:ht,shadowUrl:ht,iconSize:[24,24],shadowSize:[24,24],iconAnchor:[12,12],shadowAnchor:[12,12],popupAnchor:[-3,-76]}),Ot=function(e){var t=e.initialPoint,n=e.startPoint,c=e.range,a=e.checkpoints,i=e.onDrag,r=e.onClick,o=e.onChange,s=Object(l.useRef)(null),d=Object(l.useRef)(null),j=Object(l.useState)(!1),u=Object(O.a)(j,2),b=u[0],h=u[1];return Object(l.useEffect)((function(){var e=bt.map("mapid").setView(t,13);return bt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors,',maxZoom:18,id:"osm/streets",tileSize:512,zoomOffset:-1}).addTo(e),s.current=e,function(){e.off(),e.remove()}}),[t]),Object(l.useEffect)((function(){var e=s.current;if(e){var t=function(e){var t=e.latlng;r(t)};return e.on("click",t),function(){e.off("click",t)}}}),[r,s]),Object(l.useEffect)((function(){var e=s.current;if(n&&e){var t=bt.circle(n,{color:"red",opacity:.5,fillColor:"#fff",fillOpacity:.2,radius:500}).addTo(e),c=bt.marker(n,{draggable:!0});return c.on("dragstart",(function(e){h(!0)})),c.on("dragend",(function(e){h(!1)})),c.on("dragend",(function(e){var t=e.target.getLatLng();i(t)})),c.on("drag",(function(e){var n=e.target.getLatLng();t.setLatLng(n)})),e.addLayer(c),d.current=t,function(){d.current=null,e.removeLayer(c),e.removeLayer(t)}}}),[n,s,i]),Object(l.useEffect)((function(){d.current&&d.current.setRadius(c)}),[c,d]),Object(l.useEffect)((function(){var e;if(s.current&&d.current&&a&&!b){var t=null!==(e=null===a||void 0===a?void 0:a.map((function(e,t){return bt.marker([e.lat,e.lng],{draggable:!0,icon:pt}).bindTooltip("".concat(t+1),{permanent:!0,interactive:!1,className:"checkpoint-label",direction:"right"})})))&&void 0!==e?e:[];return t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.addLayer(e)})),t.forEach((function(e){e.on("dragend",(function(e){var n=t.map((function(e){return e.getLatLng()}));o(n)}))})),function(){t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.removeLayer(e)}))}}}),[a,d,s,b,o]),Object(le.jsx)("div",{id:"mapid",style:{height:"100%"}})},xt=Object(ee.a)(De||(De=Object(Z.a)(["\n  query getVirtualPoints ($input: PointsNearbyInput!) {\n    pointsNearby(input: $input) {\n      points {\n        lat\n        lng\n      }\n    }\n  }\n"]))),ft=Object(ee.a)($e||($e=Object(Z.a)(["\n  mutation CreateVirtualChallenge(\n    $input: CreateVirtualChallengeInput!\n  ) {\n    createVirtualChallenge(\n      input: $input\n    ) {\n      success\n      virtualChallenge {\n        id\n        name\n        checkpoints {\n          points {\n            lat\n            lng\n          }\n          totalCount\n        }\n      }\n    }\n  }\n"]))),vt=function(){var e=Object(l.useState)([]),t=Object(O.a)(e,2),n=t[0],c=t[1],a=Object(ut.a)(xt,{fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0}),i=Object(O.a)(a,2),r=i[0],o=i[1],s=o.loading,d=o.data,j=Object(X.a)(ft),u=Object(O.a)(j,1)[0],b=Object(l.useState)(null),h=Object(O.a)(b,2),p=h[0],x=h[1],f=Object(l.useMemo)((function(){return[54.372158,18.638306]}),[]),v=Object(l.useState)(500),m=Object(O.a)(v,2),g=m[0],k=m[1],y=Object(l.useCallback)((function(e){x([e.lat,e.lng])}),[x]),C=null!==p,w=Object(l.useCallback)((function(e){C||x([e.lat,e.lng])}),[C,x]),A=Object(l.useCallback)((function(e){c(e)}),[c]),S=Object(l.useCallback)((function(){u({variables:{input:{name:"Test",checkpoints:n.map((function(e){return{lat:e.lat.toString(),lng:e.lng.toString()}}))}}})}),[n,u]);return Object(l.useEffect)((function(){p&&r({variables:{input:{start:{lat:p[0].toString(),lng:p[1].toString()},radius:g,count:12}}})}),[r,g,p]),Object(l.useEffect)((function(){c(!s&&d?d.pointsNearby.points.map((function(e){var t=e.lat,n=e.lng;return{lat:parseFloat(t),lng:parseFloat(n)}})):[])}),[s,d]),Object(le.jsxs)("div",{children:[Object(le.jsxs)("div",{style:{height:200},children:[Object(le.jsx)(jt.a,{value:g,onChange:function(e,t){k(Array.isArray(t)?t[0]:t)},min:100,max:2e3,"aria-labelledby":"continuous-slider"}),Object(le.jsx)("br",{}),Object(le.jsx)(Ne.a,{onClick:S,children:"Create"})]}),Object(le.jsx)("div",{style:{position:"fixed",bottom:12,left:12,right:12,top:300},children:Object(le.jsx)(Ot,{initialPoint:f,startPoint:p,range:g,checkpoints:n,onDrag:y,onClick:w,onChange:A})})]})},mt=Object(ee.a)(Ge||(Ge=Object(Z.a)(["\n  query getVirtualChallenges {\n    virtualChallenges {\n      nodes {\n        id\n        name\n        createdAt: created_at\n        checkpoints {\n          totalCount\n          points {\n            lat\n            lng\n          }\n        }\n      }\n    }\n  }\n"]))),gt=n(164),kt=n.n(gt),yt=Object(x.a)((function(e){return Object(f.a)({addChallengeButton:{position:"absolute",right:"1em",bottom:"5em"}})})),Ct=function(){var e=he(),t=yt(),n=Object(J.a)(mt,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),c=n.data,a=n.loading,i=pe();return c?Object(le.jsxs)("div",{children:[Object(le.jsx)(Q.a,{px:1,py:2,children:Object(le.jsx)(D.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(y.a,{color:"textPrimary",className:i.link,children:[Object(le.jsx)(S.a,{className:i.icon}),"Virtual Challenges"]})})}),Object(le.jsx)(fe,{active:a}),Object(le.jsx)($.a,{children:c.virtualChallenges.nodes.map((function(e){return Object(le.jsx)(z.a,{button:!0,component:P.b,to:"/virtual-challenges/".concat(e.id),children:Object(le.jsx)(kt.a,{primary:e.name,secondary:Object(Y.a)(new Date(e.createdAt),"dd/MM/yyyy")})},e.id)}))}),Object(le.jsx)(V.a,{className:t.addChallengeButton,color:"primary","aria-label":"add",component:P.b,to:"/virtual-challenges/new",children:Object(le.jsx)(U.a,{})})]}):Object(le.jsx)("div",{children:"Loading"})},wt=Object(ee.a)(Ve||(Ve=Object(Z.a)(["\n  query getVirtualChallenge($id: Int!) {\n    virtualChallenge(id: $id) {\n      id\n      name\n      createdAt: created_at\n      checkpoints {\n        totalCount\n        points {\n          lat\n          lng\n        }\n      }\n    }\n  }\n"]))),At=Object(ee.a)(Te||(Te=Object(Z.a)(["\n  mutation EnrollVirtualChallenge($id: Int!) {\n    enrollVirtualChallenge(id: $id) {\n      success\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),St=function(){var e=he(),t=pe(),n=Object(N.f)(),c=Object(N.h)().id,a=Object(J.a)(wt,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0,variables:{id:parseInt(c,10)}}).data,i=Object(X.a)(At,{refetchQueries:[{query:te}],awaitRefetchQueries:!0,onCompleted:function(e){n.push("/events/".concat(e.enrollVirtualChallenge.event.id))},variables:{id:parseInt(c,10)}}),r=Object(O.a)(i,1)[0],o=null===a||void 0===a?void 0:a.virtualChallenge;return o?Object(le.jsxs)("div",{children:[Object(le.jsx)(Q.a,{px:1,py:2,children:Object(le.jsxs)(D.a,{"aria-label":"breadcrumb",children:[Object(le.jsxs)(C.a,{color:"inherit",component:P.b,to:"/virtual-challenges",className:t.link,children:[Object(le.jsx)(S.a,{className:t.icon}),"Virtual Challenges"]}),Object(le.jsx)(y.a,{color:"textPrimary",children:o.name})]})}),Object(le.jsx)(Ne.a,{onClick:function(){return r()},children:"Join"})]}):Object(le.jsx)("div",{children:"NOT FOUND"})},It=n(306),Et=n(165),Nt=n.n(Et),Pt=Object(l.createContext)(null),_t=function(){var e=Object(l.useContext)(Pt),t=Object(l.useState)(!1),n=Object(O.a)(t,2),c=n[0],a=n[1],i=Object(l.useState)(null),r=Object(O.a)(i,2),o=r[0],s=r[1];Object(l.useEffect)((function(){if(e){var t=function(e){s(e)};return e.onUpdate(t),function(){e.offUpdate(t)}}}),[e]);var j=function(){s(null)};return Object(le.jsx)(It.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:Boolean(o),onClose:j,message:"A new version of the app is available!",action:Object(le.jsxs)(d.a.Fragment,{children:[Object(le.jsx)(Ne.a,{color:"secondary",size:"small",onClick:function(){if(o){a(!0);var e=o.waiting;e&&(e.postMessage({type:"SKIP_WAITING"}),e.addEventListener("statechange",(function(e){var t=e.target?e.target:null;"activated"===(null===t||void 0===t?void 0:t.state)&&window.location.reload()})))}},disabled:c,children:"RELOAD"}),Object(le.jsx)(G.a,{size:"small","aria-label":"close",color:"inherit",onClick:j,children:Object(le.jsx)(Nt.a,{fontSize:"small"})})]})})},Lt=n(138),Wt=function(){return Object(_.a)({uri:"https://woodtime-api.ertrzyiks.me/woodtime"})},Bt=Object(x.a)((function(e){return Object(f.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},loaderWrapper:{alignItems:"center",width:"100%",height:"100%",justifyContent:"center",display:"flex"},bottomBar:{position:"fixed",bottom:0,width:"100%"}})}));function Rt(e){var t=e.className,n=Object(N.f)(),c=Object(N.g)();return"/"!==c.pathname&&"/virtual-challenges"!==c.pathname?null:Object(le.jsxs)(v.a,{value:"/"===c.pathname?0:1,onChange:function(e,t){0===t?n.push("/"):n.push("/virtual-challenges")},showLabels:!0,className:t,children:[Object(le.jsx)(m.a,{label:"Events",icon:Object(le.jsx)(E.a,{})}),Object(le.jsx)(m.a,{label:"Virtual Challenges",icon:Object(le.jsx)(S.a,{})})]})}var zt=function(){var e=Object(l.useState)(null),t=Object(O.a)(e,2),n=t[0],c=t[1],a=Bt();return Object(l.useEffect)((function(){function e(){return(e=Object(p.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new L.a,e.next=3,Object(Lt.b)({cache:t,storage:new Lt.a(window.localStorage)});case 3:c(new W.a({cache:t,link:Wt()}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch(console.error)}),[c]),Object(le.jsxs)(P.a,{basename:"",children:[Object(le.jsx)(_t,{}),Object(le.jsxs)(be,{children:[Object(le.jsx)(g.a,{position:"static",children:Object(le.jsx)(k.a,{children:Object(le.jsx)(y.a,{variant:"h6",className:a.title,children:Object(le.jsx)(C.a,{component:P.b,to:"/",color:"inherit",children:"Woodtime"})})})}),n?Object(le.jsxs)(B.a,{client:n,children:[Object(le.jsxs)(N.c,{children:[Object(le.jsx)(N.a,{path:"/",exact:!0,children:Object(le.jsx)(ge,{})}),Object(le.jsxs)(N.a,{path:"/events/new",exact:!0,children:[Object(le.jsx)(ge,{}),Object(le.jsx)(Le,{})]}),Object(le.jsx)(N.a,{path:"/events/:id",exact:!0,children:Object(le.jsx)(rt,{})}),Object(le.jsx)(N.a,{path:"/events/:id/add-checkpoint",exact:!0,children:Object(le.jsx)(dt,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges",exact:!0,children:Object(le.jsx)(Ct,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges/new",exact:!0,children:Object(le.jsx)(vt,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges/:id",exact:!0,children:Object(le.jsx)(St,{})})]}),Object(le.jsx)(Rt,{className:a.bottomBar})]}):Object(le.jsx)("div",{className:a.loaderWrapper,children:Object(le.jsx)(w.a,{})})]})]})},Ft=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Qt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Dt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,312)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),i(e),r(e)}))},$t=[],Gt=[],Vt=function(e){var t=e.children,n={onSuccess:function(e){return $t.push(e)},offSuccess:function(e){return $t.filter((function(t){return t!==e}))},onUpdate:function(e){return Gt.push(e)},offUpdate:function(e){return Gt.filter((function(t){return t!==e}))}};return Object(le.jsx)(Pt.Provider,{value:n,children:t})};u.a.render(Object(le.jsx)(d.a.StrictMode,{children:Object(le.jsx)(Vt,{children:Object(le.jsx)(zt,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Ft?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Qt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Qt(t,e)}))}}({onUpdate:function(e){Gt.forEach((function(t){return t(e)}))},onSuccess:function(){$t.forEach((function(e){return e()}))}}),Dt()}},[[228,1,2]]]);
//# sourceMappingURL=main.5eb3d160.chunk.js.map