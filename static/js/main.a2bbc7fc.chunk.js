(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{192:function(e,t,n){},227:function(e,t,n){"use strict";n.r(t);var a,c,i,r,o,s,l=n(0),d=n.n(l),j=n(17),u=n.n(j),b=(n(192),n(134)),h=n.n(b),p=n(156),O=n(14),f=n(266),x=n(268),m=n(290),v=n(291),g=n(292),k=n(293),y=n(54),C=n(288),A=n(295),w=n(83),S=n.n(w),E=n(81),I=n.n(E),N=n(25),P=n(27),L=n(167),W=n(298),_=n(297),B=n(294),z=n(168),F=n(271),R=n(272),D=n(305),$=n(303),G=n(270),Q=n(236),V=n(279),T=n(82),U=n.n(T),q=n(120),H=n.n(q),K=n(163),M=n.n(K),Y=n(166),J=n(274),X=n(308),Z=n(22),ee=n(23),te=Object(ee.a)(a||(a=Object(Z.a)(["\n  query getEvents {\n    events {\n      id\n      name\n      checkpoint_count\n      created_at\n    }\n  }\n"]))),ne=Object(ee.a)(c||(c=Object(Z.a)(["\n  query getEvent($id: Int!) {\n    event(id: $id) {\n      id\n      name\n      type\n      checkpoint_count\n      virtual_challenge {\n        id\n      }\n      checkpoints {\n        id\n        cp_id\n        cp_code\n        event_id\n        skipped\n        skip_reason\n      }\n    }\n  }\n"]))),ae=Object(ee.a)(i||(i=Object(Z.a)(["\n  mutation CreateEvent($name: String!, $checkpointCount: Int!, $type: Int!) {\n    createEvent(name: $name, checkpointCount: $checkpointCount, type: $type) {\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),ce=Object(ee.a)(r||(r=Object(Z.a)(["\n  mutation CreateCheckpoint(\n    $eventId: Int!\n    $cpId: Int!\n    $cpCode: String\n    $skipped: Boolean\n    $skipReason: String\n  ) {\n    createCheckpoint(\n      event_id: $eventId\n      cp_id: $cpId\n      cp_code: $cpCode\n      skipped: $skipped\n      skip_reason: $skipReason\n    ) {\n      checkpoint {\n        id\n        event_id\n        cp_id\n        cp_code\n        skipped\n        skip_reason\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),ie=Object(ee.a)(o||(o=Object(Z.a)(["\n  mutation DeleteEvent($id: Int!) {\n    deleteEvent(id: $id) {\n      id\n    }\n  }\n"]))),re=Object(ee.a)(s||(s=Object(Z.a)(["\n  mutation DeleteCheckpoint($id: Int!) {\n    deleteCheckpoint(id: $id) {\n      id\n    }\n  }\n"]))),oe=n(302),se=n(269),le=n(2),de=Object(f.a)((function(e){return Object(x.a)({listWrapper:{padding:10}})})),je=function(e){var t=de();return Object(le.jsxs)(oe.a,{"aria-labelledby":"simple-checklist-title",open:!0,onClose:e.handleClose,children:[Object(le.jsx)(se.a,{id:"simple-checklist-title",children:"Rzeczy do zabrania"}),Object(le.jsx)(G.a,{className:t.listWrapper,children:["4 kanapki","dwa bidony wody","kubek Kuby","jab\u0142ko w kawa\u0142kach","banan","ciastka","pampersy","chusteczki mokre","worek na \u015bmieci","chusteczki zwyk\u0142e","p\u0119seta","octenisept","\u017cel do dezynfekcji"].map((function(e,t){return Object(le.jsx)(F.a,{dense:!0,children:Object(le.jsx)(R.a,{primary:e,primaryTypographyProps:{variant:"body1"}})},t)}))})]})},ue=d.a.createContext(!1),be=function(e){var t=e.children,n=Object(l.useState)(null),a=Object(O.a)(n,2),c=a[0],i=a[1],r=Object(l.useState)(!0),o=Object(O.a)(r,2),s=o[0],d=o[1],j=Object(N.g)();return Object(l.useEffect)((function(){c?c!==j.pathname&&d(!1):i(j.pathname)}),[c,j.pathname,s,d]),Object(le.jsx)(ue.Provider,{value:(!c||c===j.pathname)&&s,children:t})};function he(){return Object(l.useContext)(ue)}var pe=Object(f.a)((function(e){return Object(x.a)({link:{display:"flex"},icon:{marginRight:e.spacing(.5),width:20,height:20}})})),Oe=n(273),fe=Object(f.a)((function(e){return Object(x.a)({root:{height:4}})})),xe=function(e){var t=e.active,n=fe();return Object(le.jsx)("div",{className:n.root,children:t&&Object(le.jsx)(Oe.a,{color:"secondary"})})},me=function(e){var t=e.id,n=e.name,a=e.createdAt;return Object(le.jsx)(F.a,{button:!0,component:P.b,to:"/events/".concat(t),children:Object(le.jsx)(R.a,{primary:n,secondary:Object(Y.a)(new Date(a),"dd/MM/yyyy")})})},ve=Object(f.a)((function(e){return Object(x.a)({wrapper:{display:"flex",width:"100%"},deleteIcon:{},icons:{display:"flex",justifyContent:"space-between"},listWrapper:{},addEventButton:{position:"absolute",right:"1em",bottom:"5em"}})})),ge=function(){var e=he(),t=Object(J.a)(te,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),n=t.loading,a=t.error,c=t.data,i=Object(l.useState)(!1),r=Object(O.a)(i,2),o=r[0],s=r[1],d=Object(X.a)(ie,{refetchQueries:["getEvents"],awaitRefetchQueries:!0}),j=Object(O.a)(d,1)[0],u=ve(),b=pe();return n&&!c?Object(le.jsx)("p",{children:"Loading..."}):a?Object(le.jsx)("p",{children:"Error :("}):Object(le.jsxs)("div",{className:u.listWrapper,children:[Object(le.jsx)(D.a,{px:1,py:2,children:Object(le.jsx)($.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(y.a,{color:"textPrimary",className:b.link,children:[Object(le.jsx)(I.a,{className:b.icon}),"Events"]})})}),Object(le.jsx)(xe,{active:n}),a&&Object(le.jsx)("p",{children:"Error :("}),Object(le.jsx)(G.a,{children:Object(z.a)(c.events).sort((function(e,t){return t.id-e.id})).map((function(e){var t=e.id,n=e.name,a=e.created_at;return Object(le.jsxs)("div",{className:u.wrapper,children:[Object(le.jsx)(me,{id:t,name:n,createdAt:a}),Object(le.jsxs)("div",{className:u.icons,children:[Object(le.jsx)(Q.a,{"aria-label":"checklist",onClick:function(){s(!0)},children:Object(le.jsx)(M.a,{})}),Object(le.jsx)(Q.a,{"aria-label":"delete",onClick:function(){return j({variables:{id:t}})},children:Object(le.jsx)(H.a,{})})]})]},t)}))}),o&&Object(le.jsx)(je,{handleClose:function(){s(!1)}}),Object(le.jsx)(V.a,{className:u.addEventButton,color:"primary","aria-label":"add",component:P.b,to:"/events/new",children:Object(le.jsx)(U.a,{})})]})},ke=n(280),ye=n(296),Ce=n(281),Ae=n(282),we=n(306),Se=n(284),Ee=n(300),Ie=n(285),Ne=n(286),Pe=n(47),Le=Object(f.a)((function(e){return Object(x.a)({radioGroupWrapper:{paddingTop:25,paddingBottom:10},title:{paddingBottom:0},radioLabel:{fontSize:"0.6rem"}})})),We=function(){var e=Object(l.useState)(""),t=Object(O.a)(e,2),n=t[0],a=t[1],c=Object(l.useState)(""),i=Object(O.a)(c,2),r=i[0],o=i[1],s=Object(l.useState)("score"),d=Object(O.a)(s,2),j=d[0],u=d[1],b=Object(N.f)(),h=Object(X.a)(ae,{refetchQueries:[{query:te}],awaitRefetchQueries:!0,onCompleted:function(e){b.push("/events/".concat(e.createEvent.event.id))}}),p=Object(O.a)(h,1)[0],f=Le(),x=function(){b.push("/")};return Object(le.jsxs)(oe.a,{open:!0,keepMounted:!0,onClose:x,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(le.jsx)(se.a,{id:"alert-dialog-slide-title",className:f.title,children:"Create a new event"}),Object(le.jsx)(Pe.b,{onSubmit:function(){var e="score"===j?1:2;return p({variables:{name:n,checkpointCount:parseInt(r,10),type:e}})},render:function(e){var t=e.handleSubmit;return Object(le.jsxs)("form",{onSubmit:t,children:[Object(le.jsxs)(ke.a,{children:[Object(le.jsx)(Pe.a,{name:"name",render:function(e){e.input;var t=e.meta;return Object(le.jsxs)("div",{children:[Object(le.jsx)(ye.a,{id:"standard-basic",label:"Name",required:!0,autoComplete:"off",onChange:function(e){return a(e.target.value)}}),t.touched&&t.error&&Object(le.jsx)("span",{children:t.error})]})}}),Object(le.jsx)(Pe.a,{name:"points",render:function(e){e.input;var t=e.meta;return Object(le.jsxs)("div",{children:[Object(le.jsx)(ye.a,{id:"standard-basic",label:"Points",required:!0,autoComplete:"off",onChange:function(e){return o(e.target.value)}}),t.touched&&t.error&&Object(le.jsx)("span",{children:t.error})]})}}),Object(le.jsx)(Pe.a,{name:"type",render:function(){return Object(le.jsx)("div",{className:f.radioGroupWrapper,children:Object(le.jsxs)(Ce.a,{component:"fieldset",children:[Object(le.jsx)(Ae.a,{component:"legend",children:"Type"}),Object(le.jsxs)(we.a,{"aria-label":"type",name:"type",value:j,onChange:function(e){return u(e.target.value)},children:[Object(le.jsx)(Se.a,{value:"score",control:Object(le.jsx)(Ee.a,{size:"small"}),label:Object(le.jsx)(y.a,{variant:"body2",children:"Scorelauf"})}),Object(le.jsx)(Se.a,{value:"classic",control:Object(le.jsx)(Ee.a,{size:"small"}),label:Object(le.jsx)(y.a,{variant:"body2",children:"Classic"})})]})]})})}})]}),Object(le.jsxs)(Ie.a,{children:[Object(le.jsx)(Ne.a,{variant:"contained",color:"primary",type:"submit",children:"Create"}),Object(le.jsx)(Ne.a,{onClick:x,color:"primary",children:"Cancel"})]})]})}})]})},_e=n(287),Be=n(231),ze=n(48),Fe=n(170),Re=["current","max"];var De,$e,Ge,Qe,Ve,Te=function(e){var t=e.current,n=e.max,a=Object(Fe.a)(e,Re),c=100*t/n;return Object(le.jsxs)(D.a,{display:"flex",alignItems:"center",children:[Object(le.jsx)(D.a,{width:"100%",mr:1,children:Object(le.jsx)(Oe.a,Object(ze.a)(Object(ze.a)({variant:"determinate"},a),{},{value:c}))}),Object(le.jsx)(D.a,{minWidth:35,children:Object(le.jsxs)(y.a,{variant:"body2",color:"textSecondary",children:[t,"/",n]})})]})},Ue=function(e){var t=e.scoredIds,n=e.max,a=Array(n).fill(n).map((function(e,t){return 1+t})).filter((function(e){return!t.includes(e)}));return 0===t.length||t.length===n?null:Object(le.jsxs)(D.a,{mt:3,children:[Object(le.jsx)(D.a,{minWidth:35,ml:1,mb:1,children:Object(le.jsx)(y.a,{children:"Missing:"})}),Object(le.jsx)(D.a,{display:"flex",alignItems:"center",children:Object(le.jsx)(D.a,{width:"100%",ml:1,children:a.join(", ")})})]})},qe=Object(f.a)((function(e){return Object(x.a)({wrapper:{width:"100%"},header:{padding:10,paddingBottom:2,backgroundColor:"#c5cae9"},content:{border:"1px solid #c5cae9",width:"100%",paddingLeft:10,paddingRight:10,paddingBottom:10,padding:10,boxSizing:"border-box"},deleteIcon:{position:"absolute",top:-3,right:-5}})})),He=function(e){var t,n=e.checkpoint,a=Object(X.a)(re,{refetchQueries:["getEvent"],awaitRefetchQueries:!0}),c=Object(O.a)(a,1)[0],i=qe();return Object(le.jsxs)("div",{style:{display:"flex",flexDirection:"row",position:"relative"},children:[Object(le.jsxs)("div",{className:i.wrapper,children:[Object(le.jsx)("div",{className:i.header,children:Object(le.jsx)(y.a,{variant:"button",color:"textSecondary",children:n.cp_id})}),Object(le.jsx)("div",{className:i.content,children:Object(le.jsx)(y.a,{variant:"subtitle1",children:Object(le.jsx)("span",{children:n.skipped?"skipped":null===(t=n.cp_code)||void 0===t?void 0:t.toUpperCase()})})})]}),Object(le.jsx)("div",{className:i.deleteIcon,children:Object(le.jsx)(Q.a,{"aria-label":"delete",onClick:function(){return e=n.id,c({variables:{id:e}});var e},children:Object(le.jsx)(H.a,{})})})]})},Ke=function(e){var t=e.checkpoints,n=e.max,a=Array(n).fill(n).map((function(e,t){return 1+t})).map((function(e){var n=t.find((function(t){return t.cp_id===e}));return!n||n.skipped?"...":n.cp_code}));return Object(le.jsxs)(D.a,{mt:3,children:[Object(le.jsx)(D.a,{minWidth:35,ml:1,mb:1,children:Object(le.jsx)(y.a,{variant:"h6",children:"Solution:"})}),Object(le.jsx)(D.a,{display:"flex",alignItems:"center",children:Object(le.jsx)(D.a,{width:"100%",ml:1,children:a.join(" ")})})]})},Me=Object(f.a)((function(e){return Object(x.a)({root:{flexGrow:1,padding:20},paper:{width:80},item:{padding:5},control:{padding:e.spacing(2)},addCheckpointButton:{position:"absolute",right:"1em",bottom:"1em"}})})),Ye=function(e){var t=e.event,n=e.newCheckpointPath,a=t.checkpoints,c=d.a.useState(2),i=Object(O.a)(c,1)[0],r=Me();return Object(le.jsxs)(D.a,{m:1,children:[Object(le.jsx)(y.a,{variant:"h6",children:t.name}),Object(le.jsx)(Te,{current:a.length,max:t.checkpoint_count}),a.length>0&&Object(le.jsx)(_e.a,{container:!0,className:r.root,spacing:2,children:Object(le.jsx)(_e.a,{item:!0,xs:12,children:Object(le.jsx)(_e.a,{container:!0,justify:"flex-start",spacing:i,children:a.map((function(e){return Object(le.jsx)(_e.a,{item:!0,className:r.item,children:Object(le.jsx)(Be.a,{className:r.paper,children:Object(le.jsx)(He,{checkpoint:e,eventId:t.id})})},e.cp_id)}))})})}),Object(le.jsx)(V.a,{className:r.addCheckpointButton,color:"primary","aria-label":"add",component:P.b,to:n,children:Object(le.jsx)(U.a,{})}),Object(le.jsx)(Ue,{scoredIds:a.map((function(e){return e.cp_id})),max:t.checkpoint_count}),Object(le.jsx)(Ke,{checkpoints:a,max:t.checkpoint_count})]})},Je=function(e){var t=e.event,n=(e.virtualChallenge,e.newCheckpointPath,t.checkpoints);return Object(le.jsx)("div",{children:Object(le.jsx)(Te,{current:n.length,max:t.checkpoint_count})})},Xe=function(){var e=Object(N.h)().id,t=pe(),n=he(),a=Object(J.a)(ne,{variables:{id:parseInt(e,10)},fetchPolicy:n?"cache-and-network":void 0,nextFetchPolicy:n?"cache-first":void 0}),c=a.loading,i=a.error,r=a.data,o=null===r||void 0===r?void 0:r.event;return c&&!r?Object(le.jsx)("p",{children:"Loading..."}):Object(le.jsxs)("div",{children:[Object(le.jsx)(D.a,{px:1,py:2,children:Object(le.jsxs)($.a,{"aria-label":"breadcrumb",children:[Object(le.jsxs)(C.a,{color:"inherit",component:P.b,to:"/",className:t.link,children:[Object(le.jsx)(I.a,{className:t.icon}),"Events"]}),Object(le.jsx)(y.a,{color:"textPrimary",children:o.name})]})}),Object(le.jsx)(xe,{active:c}),i&&Object(le.jsx)("p",{children:"Error :("}),3===o.type&&o.virtual_challenge?Object(le.jsx)(Je,{event:o,virtualChallenge:o.virtual_challenge,newCheckpointPath:"/events/".concat(o.id,"/add-checkpoint")}):Object(le.jsx)(Ye,{event:o,newCheckpointPath:"/events/".concat(o.id,"/add-checkpoint")})]})},Ze=n(95),et=n(301),tt=n(68),nt=Object(f.a)((function(e){return Object(x.a)({margin:{margin:e.spacing(1)}})})),at=function(){var e=Object(N.h)().id,t=Object(N.f)(),n=Object(X.a)(ce,{refetchQueries:[{query:ne,variables:{id:parseInt(e,10)}}],awaitRefetchQueries:!0,onCompleted:function(e){t.push("/events/".concat(e.createCheckpoint.checkpoint.event_id))}}),a=Object(O.a)(n,2),c=a[0],i=a[1],r=i.loading,o=i.error,s=nt();return r?Object(le.jsx)("p",{children:"Loading..."}):o?Object(le.jsx)("p",{children:"Error :("}):Object(le.jsx)(Pe.b,{onSubmit:function(t){try{return c({variables:{eventId:parseInt(e,10),cpId:parseInt(t.cpId,10),cpCode:t.cpCode,skipped:t.skipped,skipReason:t.skipReason}})}catch(n){return n?n.message&&n.message.startsWith("Checkpoint")?{id:"Id already taken"}:Object(Ze.a)({},tt.a,n.message||n):Object(Ze.a)({},tt.a,"Something went wrong")}},initialValues:{skipped:!1},render:function(e){var t=e.values,n=e.submitError,a=e.handleSubmit;return t.skipped&&delete t.cpCode,Object(le.jsxs)("form",{onSubmit:a,children:[n&&Object(le.jsx)("div",{className:"error",children:n}),Object(le.jsx)(Pe.a,{name:"cpId",render:function(e){var t=e.input,n=e.meta;return Object(le.jsxs)("div",{className:s.margin,children:[Object(le.jsx)(ye.a,Object(ze.a)(Object(ze.a)({},t),{},{label:"Id",required:!0,autoComplete:"off"})),n.touched&&(n.error||n.submitError)&&Object(le.jsx)("span",{children:n.error||n.submitError})]})}}),Object(le.jsx)(Pe.a,{name:"cpCode",render:function(e){var n=e.input,a=e.meta;return Object(le.jsxs)("div",{className:s.margin,children:[Object(le.jsx)(ye.a,Object(ze.a)(Object(ze.a)({},n),{},{label:"Code",required:!t.skipped,disabled:t.skipped,autoComplete:"off"})),a.touched&&(a.error||a.submitError)&&Object(le.jsx)("span",{children:a.error||a.submitError})]})}}),Object(le.jsx)(Pe.a,{name:"skipped",type:"checkbox",render:function(e){var t=e.input;e.meta;return Object(le.jsx)(D.a,{display:"flex",alignItems:"center",ml:1,children:Object(le.jsx)(Se.a,{control:Object(le.jsx)(et.a,Object(ze.a)(Object(ze.a)({},t),{},{checked:t.value,name:"skipped",color:"primary"})),label:"Skip"})})}}),Object(le.jsx)(Ne.a,{variant:"contained",color:"primary",type:"submit",children:"Submit"})]})}})},ct=n(307),it=n(289),rt=n(73),ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADB/VeXAAACH0lEQVRIDbWWPU8bQRCGZ/bsJHKDROIiJh0dFESyRRKlpggWWPkNFhUSLSWiRK6pIn6DfSCSInWUgBwpFEnnKkCBAxIUFnDcDvOusGXZTrJHLltYt3czz+zHzDtm+sM4ffH+WRxfV4i4TCSTJFRw5kzH+q6l73aD4EH4eG/+8HcYHvWh/TosyKWsC/NbFtkxFIQSmB+SyylY0Z1OgSmatjEtqs2C2tT5Ea/lP1Xc937mUIB2KVy0RFss9C5DuY3xr3Pn/Q6Dz2fFj2M31FkVpiVDVM03K9uDNr35SbGxclJq/GzPhqXeS88H+MAXjH6X3g6wciHZNNng5ZPPC0f9Rr7Pv17tTNgo/sLEy92duAA4c3tFB8bQm/x+pekLHGWHnVhLH8xDmsGd6LFpLuiF4sz/FQ4WGGCBiTkjFW/i6FtWcpN/u1A4+AxcfMSdVibIPjfIc6RiWnAsACwwwdYj4jLy3GdlSWxMQJquYGuFooiSOPvYCmW/g21Q/t0K9XH0tXFMZbss8nVKYsfRhSsBQypc0JYkzl62UeYp2LjkFsd2ysspgRHEEGxc8q6lWCU53QGlBdtAzyG5KI60QoAFJtgGzQJ6DslNKwBYYILtsgjNAnp+H5keXBQYYIGJby7AnepVxUodkjvo5DuHLxgKrXa7mwsAgNNvoRr0/D47cTKtvlq4tW4vALfXcDDBSLtlDgVwQf5n03fbuPtJ42/LLeEvKdWYGdgZAAAAAElFTkSuQmCC",st=rt.icon({iconUrl:ot,shadowUrl:ot,iconSize:[24,24],shadowSize:[24,24],iconAnchor:[12,12],shadowAnchor:[12,12],popupAnchor:[-3,-76]}),lt=function(e){var t=e.initialPoint,n=e.startPoint,a=e.range,c=e.checkpoints,i=e.onDrag,r=e.onClick,o=e.onChange,s=Object(l.useRef)(null),d=Object(l.useRef)(null),j=Object(l.useState)(!1),u=Object(O.a)(j,2),b=u[0],h=u[1];return Object(l.useEffect)((function(){var e=rt.map("mapid").setView(t,13);return rt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors,',maxZoom:18,id:"osm/streets",tileSize:512,zoomOffset:-1}).addTo(e),s.current=e,function(){e.off(),e.remove()}}),[t]),Object(l.useEffect)((function(){var e=s.current;if(e){var t=function(e){var t=e.latlng;r(t)};return e.on("click",t),function(){e.off("click",t)}}}),[r,s]),Object(l.useEffect)((function(){var e=s.current;if(n&&e){var t=rt.circle(n,{color:"red",opacity:.5,fillColor:"#fff",fillOpacity:.2,radius:500}).addTo(e),a=rt.marker(n,{draggable:!0});return a.on("dragstart",(function(e){h(!0)})),a.on("dragend",(function(e){h(!1)})),a.on("dragend",(function(e){var t=e.target.getLatLng();i(t)})),a.on("drag",(function(e){var n=e.target.getLatLng();t.setLatLng(n)})),e.addLayer(a),d.current=t,function(){d.current=null,e.removeLayer(a),e.removeLayer(t)}}}),[n,s,i]),Object(l.useEffect)((function(){d.current&&d.current.setRadius(a)}),[a,d]),Object(l.useEffect)((function(){var e;if(s.current&&d.current&&c&&!b){var t=null!==(e=null===c||void 0===c?void 0:c.map((function(e,t){return rt.marker([e.lat,e.lng],{draggable:!0,icon:st}).bindTooltip("".concat(t+1),{permanent:!0,interactive:!1,className:"checkpoint-label",direction:"right"})})))&&void 0!==e?e:[];return t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.addLayer(e)})),t.forEach((function(e){e.on("dragend",(function(e){var n=t.map((function(e){return e.getLatLng()}));o(n)}))})),function(){t.forEach((function(e){var t;return null===(t=s.current)||void 0===t?void 0:t.removeLayer(e)}))}}}),[c,d,s,b,o]),Object(le.jsx)("div",{id:"mapid",style:{height:"100%"}})},dt=Object(ee.a)(De||(De=Object(Z.a)(["\n  query getVirtualPoints ($input: PointsNearbyInput!) {\n    pointsNearby(input: $input) {\n      points {\n        lat\n        lng\n      }\n    }\n  }\n"]))),jt=Object(ee.a)($e||($e=Object(Z.a)(["\n  mutation CreateVirtualChallenge(\n    $input: CreateVirtualChallengeInput!\n  ) {\n    createVirtualChallenge(\n      input: $input\n    ) {\n      success\n      virtualChallenge {\n        id\n        name\n        checkpoints {\n          points {\n            lat\n            lng\n          }\n          totalCount\n        }\n      }\n    }\n  }\n"]))),ut=function(){var e=Object(l.useState)([]),t=Object(O.a)(e,2),n=t[0],a=t[1],c=Object(it.a)(dt,{fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0}),i=Object(O.a)(c,2),r=i[0],o=i[1],s=o.loading,d=o.data,j=Object(X.a)(jt),u=Object(O.a)(j,1)[0],b=Object(l.useState)(null),h=Object(O.a)(b,2),p=h[0],f=h[1],x=Object(l.useMemo)((function(){return[54.372158,18.638306]}),[]),m=Object(l.useState)(500),v=Object(O.a)(m,2),g=v[0],k=v[1],y=Object(l.useCallback)((function(e){f([e.lat,e.lng])}),[f]),C=null!==p,A=Object(l.useCallback)((function(e){C||f([e.lat,e.lng])}),[C,f]),w=Object(l.useCallback)((function(e){a(e)}),[a]),S=Object(l.useCallback)((function(){u({variables:{input:{name:"Test",checkpoints:n.map((function(e){return{lat:e.lat.toString(),lng:e.lng.toString()}}))}}})}),[n,u]);return Object(l.useEffect)((function(){p&&r({variables:{input:{start:{lat:p[0].toString(),lng:p[1].toString()},radius:g,count:12}}})}),[r,g,p]),Object(l.useEffect)((function(){a(!s&&d?d.pointsNearby.points.map((function(e){var t=e.lat,n=e.lng;return{lat:parseFloat(t),lng:parseFloat(n)}})):[])}),[s,d]),Object(le.jsxs)("div",{children:[Object(le.jsxs)("div",{style:{height:200},children:[Object(le.jsx)(ct.a,{value:g,onChange:function(e,t){k(Array.isArray(t)?t[0]:t)},min:100,max:2e3,"aria-labelledby":"continuous-slider"}),Object(le.jsx)("br",{}),Object(le.jsx)(Ne.a,{onClick:S,children:"Create"})]}),Object(le.jsx)("div",{style:{position:"fixed",bottom:12,left:12,right:12,top:300},children:Object(le.jsx)(lt,{initialPoint:x,startPoint:p,range:g,checkpoints:n,onDrag:y,onClick:A,onChange:w})})]})},bt=Object(ee.a)(Ge||(Ge=Object(Z.a)(["\n  query getVirtualChallenges {\n    virtualChallenges {\n      nodes {\n        id\n        name\n        createdAt: created_at\n        checkpoints {\n          totalCount\n          points {\n            lat\n            lng\n          }\n        }\n      }\n    }\n  }\n"]))),ht=n(164),pt=n.n(ht),Ot=Object(f.a)((function(e){return Object(x.a)({addChallengeButton:{position:"absolute",right:"1em",bottom:"5em"}})})),ft=function(){var e=he(),t=Ot(),n=Object(J.a)(bt,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0}),a=n.data,c=n.loading,i=pe();return a?Object(le.jsxs)("div",{children:[Object(le.jsx)(D.a,{px:1,py:2,children:Object(le.jsx)($.a,{"aria-label":"breadcrumb",children:Object(le.jsxs)(y.a,{color:"textPrimary",className:i.link,children:[Object(le.jsx)(S.a,{className:i.icon}),"Virtual Challenges"]})})}),Object(le.jsx)(xe,{active:c}),Object(le.jsx)(G.a,{children:a.virtualChallenges.nodes.map((function(e){return Object(le.jsx)(F.a,{button:!0,component:P.b,to:"/virtual-challenges/".concat(e.id),children:Object(le.jsx)(pt.a,{primary:e.name,secondary:Object(Y.a)(new Date(e.createdAt),"dd/MM/yyyy")})},e.id)}))}),Object(le.jsx)(V.a,{className:t.addChallengeButton,color:"primary","aria-label":"add",component:P.b,to:"/virtual-challenges/new",children:Object(le.jsx)(U.a,{})})]}):Object(le.jsx)("div",{children:"Loading"})},xt=Object(ee.a)(Qe||(Qe=Object(Z.a)(["\n  query getVirtualChallenge($id: Int!) {\n    virtualChallenge(id: $id) {\n      id\n      name\n      createdAt: created_at\n      checkpoints {\n        totalCount\n        points {\n          lat\n          lng\n        }\n      }\n    }\n  }\n"]))),mt=Object(ee.a)(Ve||(Ve=Object(Z.a)(["\n  mutation EnrollVirtualChallenge($id: Int!) {\n    enrollVirtualChallenge(id: $id) {\n      success\n      event {\n        id\n        name\n        type\n        checkpoint_count\n        created_at\n        updated_at\n      }\n    }\n  }\n"]))),vt=function(){var e=he(),t=pe(),n=Object(N.f)(),a=Object(N.h)().id,c=Object(J.a)(xt,{fetchPolicy:e?"cache-and-network":void 0,nextFetchPolicy:e?"cache-first":void 0,variables:{id:parseInt(a,10)}}).data,i=Object(X.a)(mt,{refetchQueries:[{query:te}],awaitRefetchQueries:!0,onCompleted:function(e){n.push("/events/".concat(e.enrollVirtualChallenge.event.id))},variables:{id:parseInt(a,10)}}),r=Object(O.a)(i,1)[0],o=null===c||void 0===c?void 0:c.virtualChallenge;return o?Object(le.jsxs)("div",{children:[Object(le.jsx)(D.a,{px:1,py:2,children:Object(le.jsxs)($.a,{"aria-label":"breadcrumb",children:[Object(le.jsxs)(C.a,{color:"inherit",component:P.b,to:"/virtual-challenges",className:t.link,children:[Object(le.jsx)(S.a,{className:t.icon}),"Virtual Challenges"]}),Object(le.jsx)(y.a,{color:"textPrimary",children:o.name})]})}),Object(le.jsx)(Ne.a,{onClick:function(){return r()},children:"Join"})]}):Object(le.jsx)("div",{children:"NOT FOUND"})},gt=n(304),kt=n(165),yt=n.n(kt),Ct=Object(l.createContext)(null),At=function(){var e=Object(l.useContext)(Ct),t=Object(l.useState)(!1),n=Object(O.a)(t,2),a=n[0],c=n[1],i=Object(l.useState)(null),r=Object(O.a)(i,2),o=r[0],s=r[1];Object(l.useEffect)((function(){if(e){var t=function(e){s(e)};return e.onUpdate(t),function(){e.offUpdate(t)}}}),[e]);var j=function(){s(null)};return Object(le.jsx)(gt.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:Boolean(o),onClose:j,message:"A new version of the app is available!",action:Object(le.jsxs)(d.a.Fragment,{children:[Object(le.jsx)(Ne.a,{color:"secondary",size:"small",onClick:function(){if(o){c(!0);var e=o.waiting;e&&(e.postMessage({type:"SKIP_WAITING"}),e.addEventListener("statechange",(function(e){var t=e.target?e.target:null;"activated"===(null===t||void 0===t?void 0:t.state)&&window.location.reload()})))}},disabled:a,children:"RELOAD"}),Object(le.jsx)(Q.a,{size:"small","aria-label":"close",color:"inherit",onClick:j,children:Object(le.jsx)(yt.a,{fontSize:"small"})})]})})},wt=n(138),St=function(){return Object(L.a)({uri:"https://woodtime-api.ertrzyiks.me/woodtime"})},Et=Object(f.a)((function(e){return Object(x.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},loaderWrapper:{alignItems:"center",width:"100%",height:"100%",justifyContent:"center",display:"flex"},bottomBar:{position:"fixed",bottom:0,width:"100%"}})}));function It(e){var t=e.className,n=Object(N.f)(),a=Object(N.g)();return"/"!==a.pathname&&"/virtual-challenges"!==a.pathname?null:Object(le.jsxs)(m.a,{value:"/"===a.pathname?0:1,onChange:function(e,t){0===t?n.push("/"):n.push("/virtual-challenges")},showLabels:!0,className:t,children:[Object(le.jsx)(v.a,{label:"Events",icon:Object(le.jsx)(I.a,{})}),Object(le.jsx)(v.a,{label:"Virtual Challenges",icon:Object(le.jsx)(S.a,{})})]})}var Nt=function(){var e=Object(l.useState)(null),t=Object(O.a)(e,2),n=t[0],a=t[1],c=Et();return Object(l.useEffect)((function(){function e(){return(e=Object(p.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new W.a,e.next=3,Object(wt.b)({cache:t,storage:new wt.a(window.localStorage)});case 3:a(new _.a({cache:t,link:St()}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch(console.error)}),[a]),Object(le.jsxs)(P.a,{basename:"",children:[Object(le.jsx)(At,{}),Object(le.jsxs)(be,{children:[Object(le.jsx)(g.a,{position:"static",children:Object(le.jsx)(k.a,{children:Object(le.jsx)(y.a,{variant:"h6",className:c.title,children:Object(le.jsx)(C.a,{component:P.b,to:"/",color:"inherit",children:"Woodtime"})})})}),n?Object(le.jsxs)(B.a,{client:n,children:[Object(le.jsxs)(N.c,{children:[Object(le.jsx)(N.a,{path:"/",exact:!0,children:Object(le.jsx)(ge,{})}),Object(le.jsxs)(N.a,{path:"/events/new",exact:!0,children:[Object(le.jsx)(ge,{}),Object(le.jsx)(We,{})]}),Object(le.jsx)(N.a,{path:"/events/:id",exact:!0,children:Object(le.jsx)(Xe,{})}),Object(le.jsx)(N.a,{path:"/events/:id/add-checkpoint",exact:!0,children:Object(le.jsx)(at,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges",exact:!0,children:Object(le.jsx)(ft,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges/new",exact:!0,children:Object(le.jsx)(ut,{})}),Object(le.jsx)(N.a,{path:"/virtual-challenges/:id",exact:!0,children:Object(le.jsx)(vt,{})})]}),Object(le.jsx)(It,{className:c.bottomBar})]}):Object(le.jsx)("div",{className:c.loaderWrapper,children:Object(le.jsx)(A.a,{})})]})]})},Pt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Lt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Wt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,310)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))},_t=[],Bt=[],zt=function(e){var t=e.children,n={onSuccess:function(e){return _t.push(e)},offSuccess:function(e){return _t.filter((function(t){return t!==e}))},onUpdate:function(e){return Bt.push(e)},offUpdate:function(e){return Bt.filter((function(t){return t!==e}))}};return Object(le.jsx)(Ct.Provider,{value:n,children:t})};u.a.render(Object(le.jsx)(d.a.StrictMode,{children:Object(le.jsx)(zt,{children:Object(le.jsx)(Nt,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Pt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Lt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Lt(t,e)}))}}({onUpdate:function(e){Bt.forEach((function(t){return t(e)}))},onSuccess:function(){_t.forEach((function(e){return e()}))}}),Wt()}},[[227,1,2]]]);
//# sourceMappingURL=main.a2bbc7fc.chunk.js.map